<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/palmerpa/cis673-proj/SkewHeap.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##4329 : GHC.Types.Module^"lq_tmp$x##4331" | $k_##4330}</span><span class='hs-comment'>{-|
  Skew Heap

  - the fun of programming
-}</span></a>
<span class=hs-linenum>  6: </span>
<span class=hs-linenum>  7: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Data.Heap.Skew</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>--   -- * Data structures</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>--     Skew(..)</span>
<span class=hs-linenum> 10: </span><span class='hs-comment'>--   -- * Creating heaps</span>
<span class=hs-linenum> 11: </span><span class='hs-comment'>--   , empty</span>
<span class=hs-linenum> 12: </span><span class='hs-comment'>--   , singleton</span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>--   , insert</span>
<span class=hs-linenum> 14: </span><span class='hs-comment'>--   , fromList</span>
<span class=hs-linenum> 15: </span><span class='hs-comment'>--   -- * Converting to a list</span>
<span class=hs-linenum> 16: </span><span class='hs-comment'>--   , toList</span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>--   -- * Deleting</span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>--   , deleteMin</span>
<span class=hs-linenum> 19: </span><span class='hs-comment'>--   -- * Checking heaps</span>
<span class=hs-linenum> 20: </span><span class='hs-comment'>--   , null</span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>--   -- * Helper functions</span>
<span class=hs-linenum> 22: </span><span class='hs-comment'>--   , merge</span>
<span class=hs-linenum> 23: </span><span class='hs-comment'>--   , minimum</span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>--   , valid</span>
<span class=hs-linenum> 25: </span><span class='hs-comment'>--   , heapSort</span>
<span class=hs-linenum> 26: </span><span class='hs-comment'>--   ) where</span>
<span class=hs-linenum> 27: </span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Applicative</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.List</span> <span class='hs-layout'>(</span><span class='hs-varid'>foldl'</span><span class='hs-layout'>,</span> <span class='hs-varid'>unfoldr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 30: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>minimum</span><span class='hs-layout'>,</span> <span class='hs-varid'>maximum</span><span class='hs-layout'>,</span> <span class='hs-varid'>null</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 32: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Set</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>S</span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Set</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum> 36: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>AtLeast</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>X</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>GeInt</span> <span class='hs-num'>1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 38: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node</span> <span class='hs-layout'>(</span><span class='hs-varid'>root</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>left</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>AtLeast</span> <span class='hs-varid'>a</span> <span class='hs-varid'>root</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>right</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>AtLeast</span> <span class='hs-varid'>a</span> <span class='hs-varid'>root</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 39: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Show</span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum> 42: </span>
<span class=hs-linenum> 43: </span><span class='hs-comment'>{- Working with sets (both lists and Heaps) -}</span>
<span class=hs-linenum> 44: </span>
<span class=hs-linenum> 45: </span><span class='hs-comment'>-- set of a heap</span>
<span class=hs-linenum> 46: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>elts</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 47: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>elts</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 48: </span><span class='hs-definition'>elts</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 49: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1228:(Data.Heap.Skew.Skew a) -&gt; {VV : (Data.Set.Internal.Set a) | VV == Data.Heap.Skew.elts lq_tmp$x##1228}</span><span class='hs-definition'>elts</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1244 : (Data.Set.Internal.Set a) | Set_emp lq_tmp$x##1244}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum> 50: </span><span class='hs-definition'>elts</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1372 : (GHC.Classes.Ord a) | lq_tmp$x##1372 == $dOrd_a3h4}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1281 : (Data.Set.Internal.Set {lq_tmp$x##1287 : a^"lq_tmp$x##1286" | $k_##1285[VV##1284:=lq_tmp$x##1287][lq_tmp$x##1283:=rt##a2sa]}) | lq_tmp$x##1281 == Set_sng rt##a2sa}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.singleton</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1288 : a | lq_tmp$x##1288 == rt##a2sa}</span><span class='hs-varid'>rt</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1335 : (Data.Set.Internal.Set {lq_tmp$x##1345 : a^"lq_tmp$x##1344" | $k_##1343[VV##1342:=lq_tmp$x##1345][lq_tmp$x##1339:=fix$36$$36$dOrd_a3h4][lq_tmp$x##1340:=lq_anf$##7205759403792806798##d3qS][lq_tmp$x##1341:=lq_anf$##7205759403792806799##d3qT]}) | lq_tmp$x##1335 == Set_cup lq_anf$##7205759403792806798##d3qS lq_anf$##7205759403792806799##d3qT}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.union</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1295 : (Data.Set.Internal.Set {lq_tmp$x##1303 : a^"lq_tmp$x##1302" | $k_##1301[VV##1300:=lq_tmp$x##1303][lq_tmp$x##1298:=fix$36$$36$dOrd_a3h4][lq_tmp$x##1299:=l##a2sb]}) | lq_tmp$x##1295 == Data.Heap.Skew.elts l##a2sb}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>elts</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1307 : (Data.Heap.Skew.Skew {lq_tmp$x##1306 : a | rt##a2sa &lt;= lq_tmp$x##1306}) | Data.Heap.Skew.size lq_tmp$x##1307 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##1307 == l##a2sb}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1314 : (Data.Set.Internal.Set {lq_tmp$x##1322 : a^"lq_tmp$x##1321" | $k_##1320[VV##1319:=lq_tmp$x##1322][lq_tmp$x##1317:=fix$36$$36$dOrd_a3h4][lq_tmp$x##1318:=r##a2sc]}) | lq_tmp$x##1314 == Data.Heap.Skew.elts r##a2sc}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>elts</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1326 : (Data.Heap.Skew.Skew {lq_tmp$x##1325 : a | rt##a2sa &lt;= lq_tmp$x##1325}) | Data.Heap.Skew.size lq_tmp$x##1326 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##1326 == r##a2sc}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 51: </span>
<span class=hs-linenum> 52: </span><span class='hs-comment'>-- set of a list</span>
<span class=hs-linenum> 53: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>eltsList</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 54: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>eltsList</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 55: </span><span class='hs-definition'>eltsList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 56: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1389:[a] -&gt; {VV : (Data.Set.Internal.Set a) | VV == Data.Heap.Skew.eltsList lq_tmp$x##1389}</span><span class='hs-definition'>eltsList</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1417 : (Data.Set.Internal.Set a) | Set_emp lq_tmp$x##1417}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum> 57: </span><span class='hs-definition'>eltsList</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1514 : (GHC.Classes.Ord a) | lq_tmp$x##1514 == $dOrd_a3gR}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1460 : (Data.Set.Internal.Set {lq_tmp$x##1466 : a^"lq_tmp$x##1465" | $k_##1464[VV##1463:=lq_tmp$x##1466][lq_tmp$x##1462:=x##a2sd]}) | lq_tmp$x##1460 == Set_sng x##a2sd}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.singleton</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1467 : a | lq_tmp$x##1467 == x##a2sd}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1476 : (Data.Set.Internal.Set {lq_tmp$x##1486 : a^"lq_tmp$x##1485" | $k_##1484[VV##1483:=lq_tmp$x##1486][lq_tmp$x##1480:=fix$36$$36$dOrd_a3gR][lq_tmp$x##1481:=xs##a2se]}) | lq_tmp$x##1476 == Data.Heap.Skew.eltsList xs##a2se}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>eltsList</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1492 : [a] | len lq_tmp$x##1492 &gt;= 0
                        &amp;&amp; len lq_tmp$x##1492 &gt;= 0
                        &amp;&amp; lq_tmp$x##1492 == xs##a2se}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 58: </span>
<span class=hs-linenum> 59: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>EqElts</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>Y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 60: </span>
<span class=hs-linenum> 61: </span><span class='hs-comment'>-- assertions</span>
<span class=hs-linenum> 62: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assert</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TT</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 63: </span><span class='hs-definition'>assert</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 64: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1531:{VV##0 : GHC.Types.Bool | VV##0} -&gt; lq_tmp$x##1532:a -&gt; a</span><span class='hs-definition'>assert</span></a> <span class='hs-keyword'>_</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span><span class='hs-comment'>{- Size of a heap -}</span>
<span class=hs-linenum> 67: </span>
<span class=hs-linenum> 68: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>size</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 69: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 70: </span><span class='hs-definition'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 71: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1543:(Data.Heap.Skew.Skew a) -&gt; {VV : GHC.Types.Int | VV == Data.Heap.Skew.size lq_tmp$x##1543
                                                                &amp;&amp; VV &gt;= 0}</span><span class='hs-definition'>size</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1557 : GHC.Prim.Int# | lq_tmp$x##1557 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 72: </span><span class='hs-definition'>size</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1597 : GHC.Types.Int | lq_tmp$x##1597 == lq_anf$##7205759403792806806##d3r0}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1604 : GHC.Types.Int | lq_tmp$x##1604 == Data.Heap.Skew.size l##a2sg
                                  &amp;&amp; lq_tmp$x##1604 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1612 : (Data.Heap.Skew.Skew {lq_tmp$x##1611 : a | ds_d3q3 &lt;= lq_tmp$x##1611}) | lq_tmp$x##1612 == l##a2sg}</span><span class='hs-varid'>l</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1634 : GHC.Types.Int | lq_tmp$x##1634 == Data.Heap.Skew.size r##a2sh
                                  &amp;&amp; lq_tmp$x##1634 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1642 : (Data.Heap.Skew.Skew {lq_tmp$x##1641 : a | ds_d3q3 &lt;= lq_tmp$x##1641}) | lq_tmp$x##1642 == r##a2sh}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum> 73: </span>
<span class=hs-linenum> 74: </span><span class='hs-comment'>-- -- {-| Empty heap.-}</span>
<span class=hs-linenum> 75: </span>
<span class=hs-linenum> 76: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = 0 &amp;&amp; elts r = S.empty}</span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 77: </span><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 78: </span><a class=annot href="#"><span class=annottext>forall a .
{r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == 0
                               &amp;&amp; Data.Heap.Skew.elts r == Set_empty 0}</span><span class='hs-definition'>empty</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span>
<span class=hs-linenum> 79: </span>
<span class=hs-linenum> 80: </span><span class='hs-comment'>-- -- {- See if the heap is empty.-}</span>
<span class=hs-linenum> 81: </span>
<span class=hs-linenum> 82: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>null</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{b :</span> <span class='hs-conid'>Bool</span> <span class='hs-keyword'>| b &lt;=&gt; size s = 0}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 83: </span><span class='hs-definition'>null</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 84: </span><a class=annot href="#"><span class=annottext>forall t .
lq_tmp$x##1671:(Data.Heap.Skew.Skew t) -&gt; {b : GHC.Types.Bool | b &lt;=&gt; Data.Heap.Skew.size lq_tmp$x##1671 == 0}</span><span class='hs-definition'>null</span></a> <span class='hs-conid'>Leaf</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1684 : GHC.Types.Bool | lq_tmp$x##1684
                                   &amp;&amp; lq_tmp$x##1684 == GHC.Types.True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum> 85: </span><span class='hs-definition'>null</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1715 : GHC.Types.Bool | not lq_tmp$x##1715
                                   &amp;&amp; lq_tmp$x##1715 == GHC.Types.False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum> 86: </span>
<span class=hs-linenum> 87: </span><span class='hs-comment'>-- -- {-| Singleton heap.-}</span>
<span class=hs-linenum> 88: </span>
<span class=hs-linenum> 89: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = 1 &amp;&amp; elts r = S.singleton x }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 90: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 91: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1720:a -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == 1
                                                   &amp;&amp; Data.Heap.Skew.elts r == Set_sng lq_tmp$x##1720}</span><span class='hs-definition'>singleton</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Node</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1753 : a | lq_tmp$x##1753 == x##a2ub}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1723 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.elts lq_tmp$x##1723 == Set_empty 0
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##1723 == 0}</span><span class='hs-conid'>Leaf</span></a> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1730 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.elts lq_tmp$x##1730 == Set_empty 0
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##1730 == 0}</span><span class='hs-conid'>Leaf</span></a>
<span class=hs-linenum> 92: </span>
<span class=hs-linenum> 93: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum> 94: </span>
<span class=hs-linenum> 95: </span><span class='hs-comment'>-- -- {-| Insertion. -}</span>
<span class=hs-linenum> 96: </span>
<span class=hs-linenum> 97: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = 1 + size s &amp;&amp; elts r = S.union (elts s) (S.singleton x)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 98: </span><span class='hs-definition'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 99: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##3993:a -&gt; lq_tmp$x##3994:(Data.Heap.Skew.Skew a) -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == 1 + Data.Heap.Skew.size lq_tmp$x##3994
                                                                                             &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts lq_tmp$x##3994) (Set_sng lq_tmp$x##3993)}</span><span class='hs-definition'>insert</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(Data.Heap.Skew.Skew a)</span><span class='hs-varid'>t</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>merge</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4000 : (Data.Heap.Skew.Skew {lq_tmp$x##4006 : a^"lq_tmp$x##4005" | $k_##4004[VV##4003:=lq_tmp$x##4006][lq_tmp$x##4002:=x##a2uc]}) | Data.Heap.Skew.size lq_tmp$x##4000 == 1
                                                                                                                                               &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##4000 == Set_sng x##a2uc}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>singleton</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4007 : a | lq_tmp$x##4007 == x##a2uc}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4032 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##4032 &gt;= 0
                                            &amp;&amp; lq_tmp$x##4032 == t##a2ud}</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum>100: </span>
<span class=hs-linenum>101: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-comment'>-- -- {-| Creating a heap from a list. -}</span>
<span class=hs-linenum>104: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = len l &amp;&amp; elts r = eltsList l}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>105: </span><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>106: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##4054:[a] -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == len lq_tmp$x##4054
                                                     &amp;&amp; Data.Heap.Skew.elts r == Data.Heap.Skew.eltsList lq_tmp$x##4054}</span><span class='hs-definition'>fromList</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##4082 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.elts lq_tmp$x##4082 == Set_empty 0
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##4082 == 0}</span><span class='hs-conid'>Leaf</span></a>
<span class=hs-linenum>107: </span><span class='hs-definition'>fromList</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4167 : (GHC.Classes.Ord a) | lq_tmp$x##4167 == $dOrd_a3gc}</span><span class='hs-varid'>insert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4168 : a | lq_tmp$x##4168 == x##a2ue}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4130 : (Data.Heap.Skew.Skew {lq_tmp$x##4140 : a^"lq_tmp$x##4139" | $k_##4138[VV##4137:=lq_tmp$x##4140][lq_tmp$x##4134:=fix$36$$36$dOrd_a3gc][lq_tmp$x##4135:=xs##a2uf]}) | Data.Heap.Skew.size lq_tmp$x##4130 == len xs##a2uf
                                                                                                                                                                                      &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##4130 == Data.Heap.Skew.eltsList xs##a2uf}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromList</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4146 : [a] | len lq_tmp$x##4146 &gt;= 0
                        &amp;&amp; len lq_tmp$x##4146 &gt;= 0
                        &amp;&amp; lq_tmp$x##4146 == xs##a2uf}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>108: </span>
<span class=hs-linenum>109: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>110: </span>
<span class=hs-linenum>111: </span><span class='hs-comment'>-- Stuff about toList, which is not quite done - Liquid Haskell cannot verify the set relation</span>
<span class=hs-linenum>112: </span>
<span class=hs-linenum>113: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>app</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>l1</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>l2</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| eltsList r = S.union (S.singleton x) (S.union (eltsList l1) (eltsList l2)) &amp;&amp; len r = 1 + len l1 + len l2}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>114: </span><span class='hs-definition'>app</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>115: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1764:a -&gt; lq_tmp$x##1765:[a] -&gt; lq_tmp$x##1766:[a] -&gt; {r : [a] | Data.Heap.Skew.eltsList r == Set_cup (Set_sng lq_tmp$x##1764) (Set_cup (Data.Heap.Skew.eltsList lq_tmp$x##1765) (Data.Heap.Skew.eltsList lq_tmp$x##1766))
                                                                           &amp;&amp; len r == (1 + len lq_tmp$x##1765) + len lq_tmp$x##1766}</span><span class='hs-definition'>app</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-conid'>[]</span> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>l2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1821 : a | lq_tmp$x##1821 == x##a2ug}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1825 : [a] | len lq_tmp$x##1825 &gt;= 0
                        &amp;&amp; len lq_tmp$x##1825 &gt;= 0
                        &amp;&amp; lq_tmp$x##1825 == l2##a2uh}</span><span class='hs-varid'>l2</span></a>
<span class=hs-linenum>116: </span><span class='hs-definition'>app</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span><span class='hs-conop'>:</span><span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>l2</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1928 : a | lq_tmp$x##1928 == h##a2uj}</span><span class='hs-varid'>h</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1875 : [{lq_tmp$x##1890 : a^"lq_tmp$x##1889" | $k_##1888[VV##1887:=lq_tmp$x##1890][lq_tmp$x##1881:=x##a2ug][lq_tmp$x##1882:=t##a2uk][lq_tmp$x##1883:=l2##a2uh]}] | Data.Heap.Skew.eltsList lq_tmp$x##1875 == Set_cup (Set_sng x##a2ug) (Set_cup (Data.Heap.Skew.eltsList t##a2uk) (Data.Heap.Skew.eltsList l2##a2uh))
                                                                                                                                                                              &amp;&amp; len lq_tmp$x##1875 == (1 + len t##a2uk) + len l2##a2uh}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>app</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1891 : a | lq_tmp$x##1891 == x##a2ug}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1895 : [a] | len lq_tmp$x##1895 &gt;= 0
                        &amp;&amp; len lq_tmp$x##1895 &gt;= 0
                        &amp;&amp; lq_tmp$x##1895 == t##a2uk}</span><span class='hs-varid'>t</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1900 : [a] | len lq_tmp$x##1900 &gt;= 0
                        &amp;&amp; len lq_tmp$x##1900 &gt;= 0
                        &amp;&amp; lq_tmp$x##1900 == l2##a2uh}</span><span class='hs-varid'>l2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>117: </span>
<span class=hs-linenum>118: </span><span class='hs-comment'>-- {-@ measure eltsTriple @-}</span>
<span class=hs-linenum>119: </span><span class='hs-comment'>-- eltsTriple :: Ord a =&gt; (a, Skew a, Skew a) -&gt; Set a</span>
<span class=hs-linenum>120: </span><span class='hs-comment'>-- eltsTriple (x, l, r) = S.union (S.singleton x) (S.union (elts l) (elts r))</span>
<span class=hs-linenum>121: </span>
<span class=hs-linenum>122: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>fst'</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>123: </span><span class='hs-definition'>fst'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>124: </span><a class=annot href="#"><span class=annottext>forall a b c .
lq_tmp$x##1965:(a, b, c) -&gt; {VV : a | VV == Data.Heap.Skew.fst' lq_tmp$x##1965}</span><span class='hs-definition'>fst'</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2036 : a | lq_tmp$x##2036 == x##a2um}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>125: </span>
<span class=hs-linenum>126: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>snd'</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>127: </span><span class='hs-definition'>snd'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>128: </span><a class=annot href="#"><span class=annottext>forall a b c .
lq_tmp$x##2048:(a, b, c) -&gt; {VV : b | VV == Data.Heap.Skew.snd' lq_tmp$x##2048}</span><span class='hs-definition'>snd'</span></a> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2119 : b | lq_tmp$x##2119 == x##a2un}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>129: </span>
<span class=hs-linenum>130: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>trd'</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>131: </span><span class='hs-definition'>trd'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>132: </span><a class=annot href="#"><span class=annottext>forall a b c .
lq_tmp$x##2131:(a, b, c) -&gt; {VV : c | VV == Data.Heap.Skew.trd' lq_tmp$x##2131}</span><span class='hs-definition'>trd'</span></a> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2202 : c | lq_tmp$x##2202 == x##a2uo}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>133: </span>
<span class=hs-linenum>134: </span><span class='hs-comment'>-- {-@ measure sizeTriple @-}</span>
<span class=hs-linenum>135: </span><span class='hs-comment'>-- {-@ sizeTriple :: (a, Skew a, Skew a) -&gt; Pos @-}</span>
<span class=hs-linenum>136: </span><span class='hs-comment'>-- sizeTriple :: (a, Skew a, Skew a) -&gt; Int</span>
<span class=hs-linenum>137: </span><span class='hs-comment'>-- sizeTriple (_, l, r) =</span>
<span class=hs-linenum>138: </span>
<span class=hs-linenum>139: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>eltsSubtreeLemma</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{s:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>140: </span>    <span class='hs-keyword'>{v:</span><span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>|
        (elts s = S.union (S.singleton (fst' v)) (S.union (elts (snd' v)) (elts (trd' v)))) &amp;&amp;
        (size s = 1 + size (snd' v) + size (trd' v)) &amp;&amp;
        (size (snd' v) &lt; size s) &amp;&amp;
        (size (trd' v) &lt; size s)
    }</span>
<span class=hs-linenum>146: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>147: </span><span class='hs-definition'>eltsSubtreeLemma</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>148: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2211:{s : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size s} -&gt; {v : (a, (Data.Heap.Skew.Skew a), (Data.Heap.Skew.Skew a)) | Data.Heap.Skew.elts lq_tmp$x##2211 == Set_cup (Set_sng (Data.Heap.Skew.fst' v)) (Set_cup (Data.Heap.Skew.elts (Data.Heap.Skew.snd' v)) (Data.Heap.Skew.elts (Data.Heap.Skew.trd' v)))
                                                                                                                                         &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2211 == (1 + Data.Heap.Skew.size (Data.Heap.Skew.snd' v)) + Data.Heap.Skew.size (Data.Heap.Skew.trd' v)
                                                                                                                                         &amp;&amp; Data.Heap.Skew.size (Data.Heap.Skew.snd' v) &lt; Data.Heap.Skew.size lq_tmp$x##2211
                                                                                                                                         &amp;&amp; Data.Heap.Skew.size (Data.Heap.Skew.trd' v) &lt; Data.Heap.Skew.size lq_tmp$x##2211}</span><span class='hs-definition'>eltsSubtreeLemma</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt; .
lq_tmp$x##2329:a -&gt; lq_tmp$x##2330:{lq_tmp$x##2315 : b&lt;p2 lq_tmp$x##2329&gt; | true} -&gt; lq_tmp$x##2331:{lq_tmp$x##2316 : c&lt;p3 lq_tmp$x##2330 lq_tmp$x##2329&gt; | true} -&gt; {lq_tmp$x##2325 : (a, b, c)&lt;\lq_tmp$x##2332 VV -&gt; {lq_tmp$x##2321 : b&lt;p2 lq_tmp$x##2332&gt; | true}, \lq_tmp$x##2333 lq_tmp$x##2334 VV -&gt; {lq_tmp$x##2324 : c&lt;p3 lq_tmp$x##2333 lq_tmp$x##2334&gt; | true}&gt; | x_Tuple33 lq_tmp$x##2325 == lq_tmp$x##2331
                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; x_Tuple32 lq_tmp$x##2325 == lq_tmp$x##2330
                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; x_Tuple31 lq_tmp$x##2325 == lq_tmp$x##2329
                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; Data.Heap.Skew.snd' lq_tmp$x##2325 == lq_tmp$x##2330
                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; Data.Heap.Skew.fst' lq_tmp$x##2325 == lq_tmp$x##2329
                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; Data.Heap.Skew.trd' lq_tmp$x##2325 == lq_tmp$x##2331}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2373 : a | lq_tmp$x##2373 == x##a2up}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2375 : (Data.Heap.Skew.Skew {lq_tmp$x##2374 : a | x##a2up &lt;= lq_tmp$x##2374}) | Data.Heap.Skew.size lq_tmp$x##2375 &gt;= 0
                                                                                           &amp;&amp; lq_tmp$x##2375 == l##a2uq}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2377 : (Data.Heap.Skew.Skew {lq_tmp$x##2376 : a | x##a2up &lt;= lq_tmp$x##2376}) | Data.Heap.Skew.size lq_tmp$x##2377 &gt;= 0
                                                                                           &amp;&amp; lq_tmp$x##2377 == r##a2ur}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>149: </span>
<span class=hs-linenum>150: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>len</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>151: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>len</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>152: </span><span class='hs-definition'>len</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>153: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2754:[a] -&gt; {VV : GHC.Types.Int | VV == Data.Heap.Skew.len lq_tmp$x##2754
                                            &amp;&amp; VV &gt;= 0}</span><span class='hs-definition'>len</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2780 : GHC.Prim.Int# | lq_tmp$x##2780 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>154: </span><span class='hs-definition'>len</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2826 : GHC.Types.Int | lq_tmp$x##2826 == lq_anf$##7205759403792806824##d3ri}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2835 : GHC.Types.Int | lq_tmp$x##2835 == Data.Heap.Skew.len xs##a2us
                                  &amp;&amp; lq_tmp$x##2835 &gt;= 0}</span><span class='hs-varid'>len</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2847 : [a] | len lq_tmp$x##2847 &gt;= 0
                        &amp;&amp; lq_tmp$x##2847 == xs##a2us}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>155: </span>
<span class=hs-linenum>156: </span><span class='hs-comment'>-- I think Liquid Haskell should have enough info (especially with the lemma) to infer the set relation, not sure why it isn't</span>
<span class=hs-linenum>157: </span><span class='hs-comment'>-- The lemma causes it to not be obviously terminating, though that is easily fixable</span>
<span class=hs-linenum>158: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>toList</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{l:</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len l = size s &amp;&amp; elts s = eltsList l}</span> <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>s</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>159: </span><span class='hs-definition'>toList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>160: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2393:(Data.Heap.Skew.Skew a) -&gt; {l : [a] | len l == Data.Heap.Skew.size lq_tmp$x##2393
                                                     &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2393 == Data.Heap.Skew.eltsList l}</span><span class='hs-definition'>toList</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a &lt;p :: a a -&gt; Bool&gt; .
{lq_tmp$x##2411 : [a]&lt;\lq_tmp$x##2412 VV -&gt; {lq_tmp$x##2410 : a&lt;p lq_tmp$x##2412&gt; | true}&gt; | Data.Heap.Skew.len lq_tmp$x##2411 == 0
                                                                                             &amp;&amp; Data.Heap.Skew.eltsList lq_tmp$x##2411 == Set_empty 0
                                                                                             &amp;&amp; Set_emp (listElts lq_tmp$x##2411)
                                                                                             &amp;&amp; len lq_tmp$x##2411 == 0}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>161: </span><span class='hs-definition'>toList</span> <span class='hs-varid'>s</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>162: </span>    <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##2479 : a^"lq_tmp$x##2481" | $k_##2480}</span><span class='hs-varid'>x'</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##2546 : (Data.Heap.Skew.Skew {VV##2543 : a^"lq_tmp$x##2545" | $k_##2544})^"lq_tmp$x##2548" | $k_##2547}</span><span class='hs-varid'>l'</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##2613 : (Data.Heap.Skew.Skew {VV##2610 : a^"lq_tmp$x##2612" | $k_##2611})^"lq_tmp$x##2615" | $k_##2614}</span><span class='hs-varid'>r'</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2466 : ({lq_tmp$x##2475 : a^"lq_tmp$x##2474" | $k_##2473[VV##2472:=lq_tmp$x##2475][lq_tmp$x##2468:=ds_d3p4]}, (Data.Heap.Skew.Skew {lq_tmp$x##2475 : a^"lq_tmp$x##2474" | $k_##2473[VV##2472:=lq_tmp$x##2475][lq_tmp$x##2468:=ds_d3p4]}), (Data.Heap.Skew.Skew {lq_tmp$x##2475 : a^"lq_tmp$x##2474" | $k_##2473[VV##2472:=lq_tmp$x##2475][lq_tmp$x##2468:=ds_d3p4]})) | Data.Heap.Skew.elts ds_d3p4 == Set_cup (Set_sng (Data.Heap.Skew.fst' lq_tmp$x##2466)) (Set_cup (Data.Heap.Skew.elts (Data.Heap.Skew.snd' lq_tmp$x##2466)) (Data.Heap.Skew.elts (Data.Heap.Skew.trd' lq_tmp$x##2466)))
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; Data.Heap.Skew.size ds_d3p4 == (1 + Data.Heap.Skew.size (Data.Heap.Skew.snd' lq_tmp$x##2466)) + Data.Heap.Skew.size (Data.Heap.Skew.trd' lq_tmp$x##2466)
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; Data.Heap.Skew.size (Data.Heap.Skew.snd' lq_tmp$x##2466) &lt; Data.Heap.Skew.size ds_d3p4
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; Data.Heap.Skew.size (Data.Heap.Skew.trd' lq_tmp$x##2466) &lt; Data.Heap.Skew.size ds_d3p4}</span><span class='hs-varid'>eltsSubtreeLemma</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2477 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##2477 &gt;= 0
                                            &amp;&amp; lq_tmp$x##2477 == ds_d3p4}</span><span class='hs-varid'>s</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>163: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{l : [{lq_tmp$x##2689 : a^"lq_tmp$x##2688" | $k_##2687[VV##2686:=lq_tmp$x##2689][lq_tmp$x##2393:=l'##a3fx]}] | len l == Data.Heap.Skew.size l'##a3fx
                                                                                                               &amp;&amp; Data.Heap.Skew.elts l'##a3fx == Data.Heap.Skew.eltsList l}</span><span class='hs-varid'>l1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2393:(Data.Heap.Skew.Skew a) -&gt; {l : [a] | len l == Data.Heap.Skew.size lq_tmp$x##2393
                                                     &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2393 == Data.Heap.Skew.eltsList l}</span><span class='hs-varid'>toList</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2691 : (Data.Heap.Skew.Skew {lq_tmp$x##2690 : a^"lq_tmp$x##2545" | $k_##2544[VV##2543:=lq_tmp$x##2690][VV##2546:=lq_tmp$x##2691]})^"lq_tmp$x##2548" | $k_##2547[VV##2546:=lq_tmp$x##2691]
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2691 &gt;= 0
                                                                                                                                                                 &amp;&amp; lq_tmp$x##2691 == l'##a3fx}</span><span class='hs-varid'>l'</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>164: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{l : [{lq_tmp$x##2705 : a^"lq_tmp$x##2704" | $k_##2703[VV##2702:=lq_tmp$x##2705][lq_tmp$x##2393:=r'##a3fz]}] | len l == Data.Heap.Skew.size r'##a3fz
                                                                                                               &amp;&amp; Data.Heap.Skew.elts r'##a3fz == Data.Heap.Skew.eltsList l}</span><span class='hs-varid'>l2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2393:(Data.Heap.Skew.Skew a) -&gt; {l : [a] | len l == Data.Heap.Skew.size lq_tmp$x##2393
                                                     &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2393 == Data.Heap.Skew.eltsList l}</span><span class='hs-varid'>toList</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2707 : (Data.Heap.Skew.Skew {lq_tmp$x##2706 : a^"lq_tmp$x##2612" | $k_##2611[VV##2610:=lq_tmp$x##2706][VV##2613:=lq_tmp$x##2707]})^"lq_tmp$x##2615" | $k_##2614[VV##2613:=lq_tmp$x##2707]
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2707 &gt;= 0
                                                                                                                                                                 &amp;&amp; lq_tmp$x##2707 == r'##a3fz}</span><span class='hs-varid'>r'</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>165: </span>    <span class='hs-comment'>-- assert (size s == 1 + size l' + size r') $</span>
<span class=hs-linenum>166: </span>    <span class='hs-comment'>-- assert (size s == 1 + len l1 + len l2) $</span>
<span class=hs-linenum>167: </span>
<span class=hs-linenum>168: </span>    <span class='hs-varid'>app</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2737 : a^"lq_tmp$x##2481" | $k_##2480[VV##2479:=lq_tmp$x##2737]
                                       &amp;&amp; lq_tmp$x##2737 == x'##a3fv}</span><span class='hs-varid'>x'</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2741 : [{lq_tmp$x##2738 : a^"lq_tmp$x##2688" | $k_##2687[VV##2686:=lq_tmp$x##2738][l:=lq_tmp$x##2741][lq_tmp$x##2393:=l'##a3fx][lq_tmp$x##2689:=lq_tmp$x##2738]}] | len lq_tmp$x##2741 == Data.Heap.Skew.size l'##a3fx
                                                                                                                                                                               &amp;&amp; Data.Heap.Skew.elts l'##a3fx == Data.Heap.Skew.eltsList lq_tmp$x##2741
                                                                                                                                                                               &amp;&amp; len lq_tmp$x##2741 &gt;= 0
                                                                                                                                                                               &amp;&amp; len lq_tmp$x##2741 &gt;= 0
                                                                                                                                                                               &amp;&amp; lq_tmp$x##2741 == l1##a2uA}</span><span class='hs-varid'>l1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2746 : [{lq_tmp$x##2743 : a^"lq_tmp$x##2704" | $k_##2703[VV##2702:=lq_tmp$x##2743][l:=lq_tmp$x##2746][lq_tmp$x##2393:=r'##a3fz][lq_tmp$x##2705:=lq_tmp$x##2743]}] | len lq_tmp$x##2746 == Data.Heap.Skew.size r'##a3fz
                                                                                                                                                                               &amp;&amp; Data.Heap.Skew.elts r'##a3fz == Data.Heap.Skew.eltsList lq_tmp$x##2746
                                                                                                                                                                               &amp;&amp; len lq_tmp$x##2746 &gt;= 0
                                                                                                                                                                               &amp;&amp; len lq_tmp$x##2746 &gt;= 0
                                                                                                                                                                               &amp;&amp; lq_tmp$x##2746 == l2##a2uB}</span><span class='hs-varid'>l2</span></a>
<span class=hs-linenum>169: </span>
<span class=hs-linenum>170: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>171: </span>
<span class=hs-linenum>172: </span><span class='hs-comment'>-- -- {-| Finding the minimum element.-}</span>
<span class=hs-linenum>173: </span>
<span class=hs-linenum>174: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>minimum</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>175: </span><span class='hs-keyword'>{-@</span><span class='hs-definition'>minimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{s:</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>176: </span><span class='hs-definition'>minimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>177: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2871:{VV : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size VV} -&gt; {VV : a | VV == Data.Heap.Skew.minimum lq_tmp$x##2871}</span><span class='hs-definition'>minimum</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2929 : a | lq_tmp$x##2929 == x##a2uC}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>178: </span>
<span class=hs-linenum>179: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>180: </span>
<span class=hs-linenum>181: </span><span class='hs-comment'>-- -- {-| Deleting the minimum element. -}</span>
<span class=hs-linenum>182: </span>
<span class=hs-linenum>183: </span><span class='hs-keyword'>{-@</span><span class='hs-definition'>deleteMin</span> <span class='hs-keyglyph'>::</span>  <span class='hs-keyword'>{s:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r + 1 = size s}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>184: </span><span class='hs-definition'>deleteMin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>185: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##3863:{s : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size s} -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r + 1 == Data.Heap.Skew.size lq_tmp$x##3863}</span><span class='hs-definition'>deleteMin</span></a> <a class=annot href="#"><span class=annottext>{s : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size s}</span><span class='hs-varid'>t</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b .
lq_tmp$x##3959:(a, b) -&gt; {lq_tmp$x##3956 : b | lq_tmp$x##3956 == snd lq_tmp$x##3959}</span><span class='hs-varid'>snd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3936 : ({lq_tmp$x##3945 : a^"lq_tmp$x##3944" | $k_##3943[VV##3942:=lq_tmp$x##3945][lq_tmp$x##3939:=fix$36$$36$dOrd_a3eB][lq_tmp$x##3940:=lq_anf$##7205759403792806853##d3rL]}, (Data.Heap.Skew.Skew {lq_tmp$x##3945 : a^"lq_tmp$x##3944" | $k_##3943[VV##3942:=lq_tmp$x##3945][lq_tmp$x##3939:=fix$36$$36$dOrd_a3eB][lq_tmp$x##3940:=lq_anf$##7205759403792806853##d3rL]
                                                                                                                                                                                                                                                      &amp;&amp; fst lq_tmp$x##3936 &lt;= lq_tmp$x##3945})) | Data.Heap.Skew.size (snd lq_tmp$x##3936) + 1 == Data.Heap.Skew.size lq_anf$##7205759403792806853##d3rL
                                                                                                                                                                                                                                                                                                   &amp;&amp; Set_cup (Data.Heap.Skew.elts (snd lq_tmp$x##3936)) (Set_sng (fst lq_tmp$x##3936)) == Data.Heap.Skew.elts lq_anf$##7205759403792806853##d3rL}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>deleteMin2</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3949 : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size lq_tmp$x##3949
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3949 &gt;= 0
                                            &amp;&amp; lq_tmp$x##3949 == t##a2uD
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3949 &gt;= 0
                                            &amp;&amp; Data.Heap.Skew.right lq_tmp$x##3949 == ds_d3nX
                                            &amp;&amp; Data.Heap.Skew.left lq_tmp$x##3949 == ds_d3nW
                                            &amp;&amp; Data.Heap.Skew.root lq_tmp$x##3949 == ds_d3nV
                                            &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3949 == Set_cup (Set_sng ds_d3nV) (Set_cup (Data.Heap.Skew.elts ds_d3nW) (Data.Heap.Skew.elts ds_d3nX))
                                            &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##3949 == ds_d3nV
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3949 == (1 + Data.Heap.Skew.size ds_d3nW) + Data.Heap.Skew.size ds_d3nX
                                            &amp;&amp; lq_tmp$x##3949 == Data.Heap.Skew.Node ds_d3nV ds_d3nW ds_d3nX
                                            &amp;&amp; Data.Heap.Skew.right lq_tmp$x##3949 == ds_d3nX
                                            &amp;&amp; Data.Heap.Skew.left lq_tmp$x##3949 == ds_d3nW
                                            &amp;&amp; Data.Heap.Skew.root lq_tmp$x##3949 == ds_d3nV
                                            &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3949 == Set_cup (Set_sng ds_d3nV) (Set_cup (Data.Heap.Skew.elts ds_d3nW) (Data.Heap.Skew.elts ds_d3nX))
                                            &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##3949 == ds_d3nV
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3949 == (1 + Data.Heap.Skew.size ds_d3nW) + Data.Heap.Skew.size ds_d3nX
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3949 &gt;= 0
                                            &amp;&amp; lq_tmp$x##3949 == lq_anf$##7205759403792806853##d3rL}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>186: </span>
<span class=hs-linenum>187: </span><span class='hs-comment'>--difference property does not work because the min could appear multiple times in the heap</span>
<span class=hs-linenum>188: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>deleteMin2</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{s:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-keyword'>{x:</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| fst(r) &lt;= x}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| size (snd r) + 1 = size s &amp;&amp; S.union (elts (snd r)) (S.singleton (fst r)) = elts s}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>189: </span><span class='hs-definition'>deleteMin2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>190: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##3466:{s : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size s} -&gt; {r : (a, (Data.Heap.Skew.Skew {VV : a | fst r &lt;= VV})) | Data.Heap.Skew.size (snd r) + 1 == Data.Heap.Skew.size lq_tmp$x##3466
                                                                                                                                     &amp;&amp; Set_cup (Data.Heap.Skew.elts (snd r)) (Set_sng (fst r)) == Data.Heap.Skew.elts lq_tmp$x##3466}</span><span class='hs-definition'>deleteMin2</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b &lt;p2 :: a b -&gt; Bool&gt; .
lq_tmp$x##3582:a -&gt; lq_tmp$x##3583:{lq_tmp$x##3574 : b&lt;p2 lq_tmp$x##3582&gt; | true} -&gt; {lq_tmp$x##3579 : (a, b)&lt;\lq_tmp$x##3584 VV -&gt; {lq_tmp$x##3578 : b&lt;p2 lq_tmp$x##3584&gt; | true}&gt; | x_Tuple22 lq_tmp$x##3579 == lq_tmp$x##3583
                                                                                                                                                                                      &amp;&amp; x_Tuple21 lq_tmp$x##3579 == lq_tmp$x##3582
                                                                                                                                                                                      &amp;&amp; snd lq_tmp$x##3579 == lq_tmp$x##3583
                                                                                                                                                                                      &amp;&amp; fst lq_tmp$x##3579 == lq_tmp$x##3582}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3605 : a | lq_tmp$x##3605 == x##a2uU}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3555 : (Data.Heap.Skew.Skew {lq_tmp$x##3565 : a^"lq_tmp$x##3564" | $k_##3563[VV##3562:=lq_tmp$x##3565][lq_tmp$x##3559:=fix$36$$36$dOrd_a3c8][lq_tmp$x##3560:=l##a2uV][lq_tmp$x##3561:=r##a2uW]}) | Data.Heap.Skew.size lq_tmp$x##3555 == Data.Heap.Skew.size l##a2uV + Data.Heap.Skew.size r##a2uW
                                                                                                                                                                                                              &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3555 == Set_cup (Data.Heap.Skew.elts l##a2uV) (Data.Heap.Skew.elts r##a2uW)}</span><span class='hs-varid'>merge</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3569 : (Data.Heap.Skew.Skew {lq_tmp$x##3568 : a | x##a2uU &lt;= lq_tmp$x##3568}) | Data.Heap.Skew.size lq_tmp$x##3569 &gt;= 0
                                                                                           &amp;&amp; lq_tmp$x##3569 == l##a2uV}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3571 : (Data.Heap.Skew.Skew {lq_tmp$x##3570 : a | x##a2uU &lt;= lq_tmp$x##3570}) | Data.Heap.Skew.size lq_tmp$x##3571 &gt;= 0
                                                                                           &amp;&amp; lq_tmp$x##3571 == r##a2uW}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>191: </span>
<span class=hs-linenum>192: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>193: </span><span class='hs-comment'>-- -- {-| Merging two heaps-}</span>
<span class=hs-linenum>194: </span>
<span class=hs-linenum>195: </span><span class='hs-comment'>-- A nonempty skew heap is bounded by its root</span>
<span class=hs-linenum>196: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>skewBoundedByRoot</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{s:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r :</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>AtLeast</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>minimum</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| size s = size r &amp;&amp; EqElts s r}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>197: </span><span class='hs-definition'>skewBoundedByRoot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>198: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2934:{VV : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size VV} -&gt; {r : (Data.Heap.Skew.Skew {VV : a | Data.Heap.Skew.minimum lq_tmp$x##2934 &lt;= VV}) | Data.Heap.Skew.size lq_tmp$x##2934 == Data.Heap.Skew.size r
                                                                                                                                                                  &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2934 == Data.Heap.Skew.elts r}</span><span class='hs-definition'>skewBoundedByRoot</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##3006:a -&gt; lq_tmp$x##3007:(Data.Heap.Skew.Skew {lq_tmp$x##2997 : a | lq_tmp$x##3006 &lt;= lq_tmp$x##2997}) -&gt; lq_tmp$x##3008:(Data.Heap.Skew.Skew {lq_tmp$x##2999 : a | lq_tmp$x##3006 &lt;= lq_tmp$x##2999}) -&gt; {lq_tmp$x##3002 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.right lq_tmp$x##3002 == lq_tmp$x##3008
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.left lq_tmp$x##3002 == lq_tmp$x##3007
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.root lq_tmp$x##3002 == lq_tmp$x##3006
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3002 == Set_cup (Set_sng lq_tmp$x##3006) (Set_cup (Data.Heap.Skew.elts lq_tmp$x##3007) (Data.Heap.Skew.elts lq_tmp$x##3008))
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##3002 == lq_tmp$x##3006
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3002 == (1 + Data.Heap.Skew.size lq_tmp$x##3007) + Data.Heap.Skew.size lq_tmp$x##3008}</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3013 : a | lq_tmp$x##3013 == rt##a2uX}</span><span class='hs-varid'>rt</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3015 : (Data.Heap.Skew.Skew {lq_tmp$x##3014 : a | rt##a2uX &lt;= lq_tmp$x##3014}) | Data.Heap.Skew.size lq_tmp$x##3015 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##3015 == l##a2uY}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3017 : (Data.Heap.Skew.Skew {lq_tmp$x##3016 : a | rt##a2uX &lt;= lq_tmp$x##3016}) | Data.Heap.Skew.size lq_tmp$x##3017 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##3017 == r##a2uZ}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>199: </span>
<span class=hs-linenum>200: </span><span class='hs-comment'>-- Boundedness is transitive</span>
<span class=hs-linenum>201: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>boundedSkewTransitive</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>AtLeast</span> <span class='hs-varid'>a</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{y:</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| y &lt;= x}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r :</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>AtLeast</span> <span class='hs-varid'>a</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| size s = size r &amp;&amp; EqElts s r}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>202: </span><span class='hs-definition'>boundedSkewTransitive</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>203: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##3023:a -&gt; lq_tmp$x##3024:(Data.Heap.Skew.Skew {VV : a | lq_tmp$x##3023 &lt;= VV}) -&gt; lq_tmp$x##3025:{VV : a | VV &lt;= lq_tmp$x##3023} -&gt; {r : (Data.Heap.Skew.Skew {VV : a | lq_tmp$x##3025 &lt;= VV}) | Data.Heap.Skew.size lq_tmp$x##3024 == Data.Heap.Skew.size r
                                                                                                                                                                                                           &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3024 == Data.Heap.Skew.elts r}</span><span class='hs-definition'>boundedSkewTransitive</span></a> <span class='hs-keyword'>_</span> <a class=annot href="#"><span class=annottext>(Data.Heap.Skew.Skew {VV : a | ds_d3mB &lt;= VV})</span><span class='hs-varid'>s</span></a> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>s</span>
<span class=hs-linenum>204: </span>
<span class=hs-linenum>205: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>merge</span> <span class='hs-keyglyph'>::</span><span class='hs-varid'>t1</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t2</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = size t1 + size t2 &amp;&amp; ((elts r) = (S.union (elts t1) (elts t2)))}</span>  <span class='hs-varop'>/</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>t1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>size</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>206: </span><span class='hs-definition'>merge</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>207: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##3053:(Data.Heap.Skew.Skew a) -&gt; lq_tmp$x##3054:(Data.Heap.Skew.Skew a) -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == Data.Heap.Skew.size lq_tmp$x##3053 + Data.Heap.Skew.size lq_tmp$x##3054
                                                                                                                   &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts lq_tmp$x##3053) (Data.Heap.Skew.elts lq_tmp$x##3054)}</span><span class='hs-definition'>merge</span></a> <a class=annot href="#"><span class=annottext>(Data.Heap.Skew.Skew a)</span><span class='hs-varid'>t1</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3071 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##3071 &gt;= 0
                                            &amp;&amp; lq_tmp$x##3071 == t1##a2v1}</span><span class='hs-varid'>t1</span></a>
<span class=hs-linenum>208: </span><span class='hs-definition'>merge</span> <span class='hs-conid'>Leaf</span> <span class='hs-varid'>t2</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3114 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##3114 &gt;= 0
                                            &amp;&amp; lq_tmp$x##3114 == ds_d3mP}</span><span class='hs-varid'>t2</span></a>
<span class=hs-linenum>209: </span><span class='hs-definition'>merge</span> <span class='hs-varid'>t1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt1</span> <span class='hs-varid'>l1</span> <span class='hs-varid'>r1</span><span class='hs-layout'>)</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt2</span> <span class='hs-varid'>l2</span> <span class='hs-varid'>r2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>210: </span>    <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3222 : a | lq_tmp$x##3222 == rt1##a2v4}</span><span class='hs-varid'>rt1</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3223 : a | lq_tmp$x##3223 == rt2##a2v8}</span><span class='hs-varid'>rt2</span></a> <span class='hs-keyword'>then</span>
<span class=hs-linenum>211: </span>        <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##3433:a -&gt; lq_tmp$x##3434:(Data.Heap.Skew.Skew {lq_tmp$x##3424 : a | lq_tmp$x##3433 &lt;= lq_tmp$x##3424}) -&gt; lq_tmp$x##3435:(Data.Heap.Skew.Skew {lq_tmp$x##3426 : a | lq_tmp$x##3433 &lt;= lq_tmp$x##3426}) -&gt; {lq_tmp$x##3429 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.right lq_tmp$x##3429 == lq_tmp$x##3435
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.left lq_tmp$x##3429 == lq_tmp$x##3434
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.root lq_tmp$x##3429 == lq_tmp$x##3433
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3429 == Set_cup (Set_sng lq_tmp$x##3433) (Set_cup (Data.Heap.Skew.elts lq_tmp$x##3434) (Data.Heap.Skew.elts lq_tmp$x##3435))
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##3429 == lq_tmp$x##3433
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3429 == (1 + Data.Heap.Skew.size lq_tmp$x##3434) + Data.Heap.Skew.size lq_tmp$x##3435}</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3440 : a | lq_tmp$x##3440 == rt1##a2v4}</span><span class='hs-varid'>rt1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3442 : (Data.Heap.Skew.Skew {lq_tmp$x##3441 : a | rt1##a2v4 &lt;= lq_tmp$x##3441}) | Data.Heap.Skew.size lq_tmp$x##3442 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3442 == r1##a2v6}</span><span class='hs-varid'>r1</span></a> <a class=annot href="#"><span class=annottext>{r : (Data.Heap.Skew.Skew {lq_tmp$x##3415 : a^"lq_tmp$x##3414" | $k_##3413[VV##3412:=lq_tmp$x##3415][lq_tmp$x##3052:=fix$36$$36$dOrd_a3bQ][lq_tmp$x##3053:=l1##a2v5][lq_tmp$x##3054:=lq_anf$##7205759403792806843##d3rB]}) | Data.Heap.Skew.size r == Data.Heap.Skew.size l1##a2v5 + Data.Heap.Skew.size lq_anf$##7205759403792806843##d3rB
                                                                                                                                                                                                                             &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts l1##a2v5) (Data.Heap.Skew.elts lq_anf$##7205759403792806843##d3rB)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>merge</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3419 : (Data.Heap.Skew.Skew {lq_tmp$x##3418 : a | rt1##a2v4 &lt;= lq_tmp$x##3418}) | Data.Heap.Skew.size lq_tmp$x##3419 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3419 == l1##a2v5}</span><span class='hs-varid'>l1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3382 : (Data.Heap.Skew.Skew {lq_tmp$x##3392 : a^"lq_tmp$x##3391" | $k_##3390[VV##3389:=lq_tmp$x##3392][lq_tmp$x##3386:=rt2##a2v8][lq_tmp$x##3387:=lq_anf$##7205759403792806842##d3rA][lq_tmp$x##3388:=rt1##a2v4]
                                                                              &amp;&amp; rt1##a2v4 &lt;= lq_tmp$x##3392}) | Data.Heap.Skew.size lq_anf$##7205759403792806842##d3rA == Data.Heap.Skew.size lq_tmp$x##3382
                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806842##d3rA == Data.Heap.Skew.elts lq_tmp$x##3382}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>boundedSkewTransitive</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3393 : a | lq_tmp$x##3393 == rt2##a2v8}</span><span class='hs-varid'>rt2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3367 : (Data.Heap.Skew.Skew {lq_tmp$x##3373 : a^"lq_tmp$x##3372" | $k_##3371[VV##3370:=lq_tmp$x##3373][lq_tmp$x##3369:=lq_anf$##7205759403792806841##d3rz]
                                                                              &amp;&amp; Data.Heap.Skew.minimum lq_anf$##7205759403792806841##d3rz &lt;= lq_tmp$x##3373}) | Data.Heap.Skew.size lq_anf$##7205759403792806841##d3rz == Data.Heap.Skew.size lq_tmp$x##3367
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806841##d3rz == Data.Heap.Skew.elts lq_tmp$x##3367}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>skewBoundedByRoot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3347 : (Data.Heap.Skew.Skew {lq_tmp$x##3357 : a^"lq_tmp$x##3356" | $k_##3355[VV##3354:=lq_tmp$x##3357][lq_tmp$x##3351:=rt2##a2v8][lq_tmp$x##3352:=l2##a2v9][lq_tmp$x##3353:=r2##a2va]}) | Data.Heap.Skew.right lq_tmp$x##3347 == r2##a2va
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.left lq_tmp$x##3347 == l2##a2v9
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.root lq_tmp$x##3347 == rt2##a2v8
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3347 == Set_cup (Set_sng rt2##a2v8) (Set_cup (Data.Heap.Skew.elts l2##a2v9) (Data.Heap.Skew.elts r2##a2va))
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##3347 == rt2##a2v8
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3347 == (1 + Data.Heap.Skew.size l2##a2v9) + Data.Heap.Skew.size r2##a2va}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Node</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3358 : a | lq_tmp$x##3358 == rt2##a2v8}</span><span class='hs-varid'>rt2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3360 : (Data.Heap.Skew.Skew {lq_tmp$x##3359 : a | rt2##a2v8 &lt;= lq_tmp$x##3359}) | Data.Heap.Skew.size lq_tmp$x##3360 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3360 == l2##a2v9}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3362 : (Data.Heap.Skew.Skew {lq_tmp$x##3361 : a | rt2##a2v8 &lt;= lq_tmp$x##3361}) | Data.Heap.Skew.size lq_tmp$x##3362 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3362 == r2##a2va}</span><span class='hs-varid'>r2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3396 : a | lq_tmp$x##3396 == rt1##a2v4}</span><span class='hs-varid'>rt1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>212: </span>    <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##3324:a -&gt; lq_tmp$x##3325:(Data.Heap.Skew.Skew {lq_tmp$x##3315 : a | lq_tmp$x##3324 &lt;= lq_tmp$x##3315}) -&gt; lq_tmp$x##3326:(Data.Heap.Skew.Skew {lq_tmp$x##3317 : a | lq_tmp$x##3324 &lt;= lq_tmp$x##3317}) -&gt; {lq_tmp$x##3320 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.right lq_tmp$x##3320 == lq_tmp$x##3326
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.left lq_tmp$x##3320 == lq_tmp$x##3325
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.root lq_tmp$x##3320 == lq_tmp$x##3324
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3320 == Set_cup (Set_sng lq_tmp$x##3324) (Set_cup (Data.Heap.Skew.elts lq_tmp$x##3325) (Data.Heap.Skew.elts lq_tmp$x##3326))
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##3320 == lq_tmp$x##3324
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3320 == (1 + Data.Heap.Skew.size lq_tmp$x##3325) + Data.Heap.Skew.size lq_tmp$x##3326}</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3331 : a | lq_tmp$x##3331 == rt2##a2v8}</span><span class='hs-varid'>rt2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3333 : (Data.Heap.Skew.Skew {lq_tmp$x##3332 : a | rt2##a2v8 &lt;= lq_tmp$x##3332}) | Data.Heap.Skew.size lq_tmp$x##3333 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3333 == r2##a2va}</span><span class='hs-varid'>r2</span></a> <a class=annot href="#"><span class=annottext>{r : (Data.Heap.Skew.Skew {lq_tmp$x##3306 : a^"lq_tmp$x##3305" | $k_##3304[VV##3303:=lq_tmp$x##3306][lq_tmp$x##3052:=fix$36$$36$dOrd_a3bQ][lq_tmp$x##3053:=l2##a2v9][lq_tmp$x##3054:=lq_anf$##7205759403792806839##d3rx]}) | Data.Heap.Skew.size r == Data.Heap.Skew.size l2##a2v9 + Data.Heap.Skew.size lq_anf$##7205759403792806839##d3rx
                                                                                                                                                                                                                             &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts l2##a2v9) (Data.Heap.Skew.elts lq_anf$##7205759403792806839##d3rx)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>merge</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3310 : (Data.Heap.Skew.Skew {lq_tmp$x##3309 : a | rt2##a2v8 &lt;= lq_tmp$x##3309}) | Data.Heap.Skew.size lq_tmp$x##3310 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3310 == l2##a2v9}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3273 : (Data.Heap.Skew.Skew {lq_tmp$x##3283 : a^"lq_tmp$x##3282" | $k_##3281[VV##3280:=lq_tmp$x##3283][lq_tmp$x##3277:=rt1##a2v4][lq_tmp$x##3278:=lq_anf$##7205759403792806838##d3rw][lq_tmp$x##3279:=rt2##a2v8]
                                                                              &amp;&amp; rt2##a2v8 &lt;= lq_tmp$x##3283}) | Data.Heap.Skew.size lq_anf$##7205759403792806838##d3rw == Data.Heap.Skew.size lq_tmp$x##3273
                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806838##d3rw == Data.Heap.Skew.elts lq_tmp$x##3273}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>boundedSkewTransitive</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3284 : a | lq_tmp$x##3284 == rt1##a2v4}</span><span class='hs-varid'>rt1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3258 : (Data.Heap.Skew.Skew {lq_tmp$x##3264 : a^"lq_tmp$x##3263" | $k_##3262[VV##3261:=lq_tmp$x##3264][lq_tmp$x##3260:=lq_anf$##7205759403792806837##d3rv]
                                                                              &amp;&amp; Data.Heap.Skew.minimum lq_anf$##7205759403792806837##d3rv &lt;= lq_tmp$x##3264}) | Data.Heap.Skew.size lq_anf$##7205759403792806837##d3rv == Data.Heap.Skew.size lq_tmp$x##3258
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806837##d3rv == Data.Heap.Skew.elts lq_tmp$x##3258}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>skewBoundedByRoot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3238 : (Data.Heap.Skew.Skew {lq_tmp$x##3248 : a^"lq_tmp$x##3247" | $k_##3246[VV##3245:=lq_tmp$x##3248][lq_tmp$x##3242:=rt1##a2v4][lq_tmp$x##3243:=l1##a2v5][lq_tmp$x##3244:=r1##a2v6]}) | Data.Heap.Skew.right lq_tmp$x##3238 == r1##a2v6
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.left lq_tmp$x##3238 == l1##a2v5
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.root lq_tmp$x##3238 == rt1##a2v4
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##3238 == Set_cup (Set_sng rt1##a2v4) (Set_cup (Data.Heap.Skew.elts l1##a2v5) (Data.Heap.Skew.elts r1##a2v6))
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##3238 == rt1##a2v4
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3238 == (1 + Data.Heap.Skew.size l1##a2v5) + Data.Heap.Skew.size r1##a2v6}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Node</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3249 : a | lq_tmp$x##3249 == rt1##a2v4}</span><span class='hs-varid'>rt1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3251 : (Data.Heap.Skew.Skew {lq_tmp$x##3250 : a | rt1##a2v4 &lt;= lq_tmp$x##3250}) | Data.Heap.Skew.size lq_tmp$x##3251 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3251 == l1##a2v5}</span><span class='hs-varid'>l1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3253 : (Data.Heap.Skew.Skew {lq_tmp$x##3252 : a | rt1##a2v4 &lt;= lq_tmp$x##3252}) | Data.Heap.Skew.size lq_tmp$x##3253 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##3253 == r1##a2v6}</span><span class='hs-varid'>r1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3287 : a | lq_tmp$x##3287 == rt2##a2v8}</span><span class='hs-varid'>rt2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>213: </span>
<span class=hs-linenum>214: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>215: </span><span class='hs-comment'>-- -- -- Basic operations</span>
<span class=hs-linenum>216: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>217: </span>
<span class=hs-linenum>218: </span><span class='hs-comment'>-- -- {-| Checking validity of a heap.</span>
<span class=hs-linenum>219: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum>220: </span>
<span class=hs-linenum>221: </span><span class='hs-comment'>-- -- valid :: Ord a =&gt; Skew a -&gt; Bool</span>
<span class=hs-linenum>222: </span><span class='hs-comment'>-- -- valid t = isOrdered (heapSort t)</span>
<span class=hs-linenum>223: </span>
<span class=hs-linenum>224: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>IncrList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-varop'>&lt;</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>xi</span> <span class='hs-varid'>xj</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xi</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>xj</span><span class='hs-layout'>}</span><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>225: </span>
<span class=hs-linenum>226: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>heapSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>IncrList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| len v = size s &amp;&amp; eltsList v = elts s}</span> <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>s</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>227: </span><span class='hs-definition'>heapSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>228: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##3631:(Data.Heap.Skew.Skew a) -&gt; {VV##0 : [a]&lt;\lq_tmp$x##3632 VV -&gt; {VV : a | lq_tmp$x##3632 &lt;= VV}&gt; | len VV##0 == Data.Heap.Skew.size lq_tmp$x##3631
                                                                                                                &amp;&amp; Data.Heap.Skew.eltsList VV##0 == Data.Heap.Skew.elts lq_tmp$x##3631}</span><span class='hs-definition'>heapSort</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a &lt;p :: a a -&gt; Bool&gt; .
{lq_tmp$x##3650 : [a]&lt;\lq_tmp$x##3651 VV -&gt; {lq_tmp$x##3649 : a&lt;p lq_tmp$x##3651&gt; | true}&gt; | Data.Heap.Skew.len lq_tmp$x##3650 == 0
                                                                                             &amp;&amp; Data.Heap.Skew.eltsList lq_tmp$x##3650 == Set_empty 0
                                                                                             &amp;&amp; Set_emp (listElts lq_tmp$x##3650)
                                                                                             &amp;&amp; len lq_tmp$x##3650 == 0}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>229: </span><span class='hs-definition'>heapSort</span> <span class='hs-varid'>h</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>230: </span>    <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##3716 : a^"lq_tmp$x##3718" | $k_##3717}</span><span class='hs-varid'>minElt</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##3758 : (Data.Heap.Skew.Skew {VV##3755 : a^"lq_tmp$x##3757" | $k_##3756})^"lq_tmp$x##3760" | $k_##3759}</span><span class='hs-varid'>h'</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3701 : ({lq_tmp$x##3710 : a^"lq_tmp$x##3709" | $k_##3708[VV##3707:=lq_tmp$x##3710][lq_tmp$x##3704:=fix$36$$36$dOrd_a3ce][lq_tmp$x##3705:=ds_d3ni]}, (Data.Heap.Skew.Skew {lq_tmp$x##3710 : a^"lq_tmp$x##3709" | $k_##3708[VV##3707:=lq_tmp$x##3710][lq_tmp$x##3704:=fix$36$$36$dOrd_a3ce][lq_tmp$x##3705:=ds_d3ni]
                                                                                                                                                                                                                           &amp;&amp; fst lq_tmp$x##3701 &lt;= lq_tmp$x##3710})) | Data.Heap.Skew.size (snd lq_tmp$x##3701) + 1 == Data.Heap.Skew.size ds_d3ni
                                                                                                                                                                                                                                                                        &amp;&amp; Set_cup (Data.Heap.Skew.elts (snd lq_tmp$x##3701)) (Set_sng (fst lq_tmp$x##3701)) == Data.Heap.Skew.elts ds_d3ni}</span><span class='hs-varid'>deleteMin2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3714 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##3714 &gt;= 0
                                            &amp;&amp; lq_tmp$x##3714 == ds_d3ni}</span><span class='hs-varid'>h</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>231: </span>        <a class=annot href="#"><span class=annottext>{lq_tmp$x##3844 : a^"lq_tmp$x##3718" | $k_##3717[VV##3716:=lq_tmp$x##3844]
                                       &amp;&amp; lq_tmp$x##3844 == minElt##a3cl}</span><span class='hs-varid'>minElt</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{VV##0 : [{lq_tmp$x##3813 : a^"lq_tmp$x##3812" | $k_##3811[VV##3810:=lq_tmp$x##3813][lq_tmp$x##3630:=fix$36$$36$dOrd_a3ce][lq_tmp$x##3631:=h'##a3cn]}]&lt;\lq_tmp$x##3632 VV -&gt; {lq_tmp$x##3813 : a^"lq_tmp$x##3812" | lq_tmp$x##3632 &lt;= lq_tmp$x##3813}&gt; | len VV##0 == Data.Heap.Skew.size h'##a3cn
                                                                                                                                                                                                                                                         &amp;&amp; Data.Heap.Skew.eltsList VV##0 == Data.Heap.Skew.elts h'##a3cn}</span><span class='hs-varid'>heapSort</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3817 : (Data.Heap.Skew.Skew {lq_tmp$x##3816 : a^"lq_tmp$x##3757" | $k_##3756[VV##3755:=lq_tmp$x##3816][VV##3758:=lq_tmp$x##3817]})^"lq_tmp$x##3760" | $k_##3759[VV##3758:=lq_tmp$x##3817]
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.size lq_tmp$x##3817 &gt;= 0
                                                                                                                                                                 &amp;&amp; lq_tmp$x##3817 == h'##a3cn}</span><span class='hs-varid'>h'</span></a>
<span class=hs-linenum>232: </span>
<span class=hs-linenum>233: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>sortUsingHeap</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>IncrList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| len v = len xs &amp;&amp; eltsList v = eltsList xs}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>234: </span><span class='hs-definition'>sortUsingHeap</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>235: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##4185:[a] -&gt; {VV##0 : [a]&lt;\lq_tmp$x##4187 VV -&gt; {VV : a | lq_tmp$x##4187 &lt;= VV}&gt; | len VV##0 == len lq_tmp$x##4185
                                                                                            &amp;&amp; Data.Heap.Skew.eltsList VV##0 == Data.Heap.Skew.eltsList lq_tmp$x##4185}</span><span class='hs-definition'>sortUsingHeap</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4200:(Data.Heap.Skew.Skew {lq_tmp$x##4205 : a^"lq_tmp$x##4204" | $k_##4203[VV##4202:=lq_tmp$x##4205][lq_tmp$x##4199:=fix$36$$36$dOrd_a3gl]}) -&gt; {lq_tmp$x##4196 : [{lq_tmp$x##4205 : a^"lq_tmp$x##4204" | $k_##4203[VV##4202:=lq_tmp$x##4205][lq_tmp$x##4199:=fix$36$$36$dOrd_a3gl]}]&lt;\lq_tmp$x##4201 VV -&gt; {lq_tmp$x##4205 : a^"lq_tmp$x##4204" | lq_tmp$x##4201 &lt;= lq_tmp$x##4205}&gt; | len lq_tmp$x##4196 == Data.Heap.Skew.size lq_tmp$x##4200
                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; Data.Heap.Skew.eltsList lq_tmp$x##4196 == Data.Heap.Skew.elts lq_tmp$x##4200}</span><span class='hs-varid'>heapSort</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4221:[{lq_tmp$x##4226 : a^"lq_tmp$x##4225" | $k_##4224[VV##4223:=lq_tmp$x##4226][lq_tmp$x##4220:=fix$36$$36$dOrd_a3gl]}] -&gt; {lq_tmp$x##4216 : (Data.Heap.Skew.Skew {lq_tmp$x##4226 : a^"lq_tmp$x##4225" | $k_##4224[VV##4223:=lq_tmp$x##4226][lq_tmp$x##4220:=fix$36$$36$dOrd_a3gl]}) | Data.Heap.Skew.size lq_tmp$x##4216 == len lq_tmp$x##4221
                                                                                                                                                                                                                                                                                                  &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##4216 == Data.Heap.Skew.eltsList lq_tmp$x##4221}</span><span class='hs-varid'>fromList</span></a>
<span class=hs-linenum>236: </span>
<span class=hs-linenum>237: </span><span class='hs-comment'>-- -- isOrdered :: Ord a =&gt; [a] -&gt; Bool</span>
<span class=hs-linenum>238: </span><span class='hs-comment'>-- -- isOrdered [] = True</span>
<span class=hs-linenum>239: </span><span class='hs-comment'>-- -- isOrdered [_] = True</span>
<span class=hs-linenum>240: </span><span class='hs-comment'>-- -- isOrdered (x:y:xys) = x &lt;= y &amp;&amp; isOrdered (y:xys) -- allowing duplicated keys</span>
</pre>
</body>
</html>