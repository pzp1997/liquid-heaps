<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/home/josh/Documents/HW/CIS673/cis673-proj/SkewHeap.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##2975 : GHC.Types.Module^"lq_tmp$x##2977" | $k_##2976}</span><span class='hs-comment'>{-|
  Skew Heap

  - the fun of programming
-}</span></a>
<span class=hs-linenum>  6: </span>
<span class=hs-linenum>  7: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Data.Heap.Skew</span> <span class='hs-keyword'>where</span> 
<span class=hs-linenum>  8: </span><span class='hs-comment'>--   -- * Data structures</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>--     Skew(..)</span>
<span class=hs-linenum> 10: </span><span class='hs-comment'>--   -- * Creating heaps</span>
<span class=hs-linenum> 11: </span><span class='hs-comment'>--   , empty</span>
<span class=hs-linenum> 12: </span><span class='hs-comment'>--   , singleton</span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>--   , insert</span>
<span class=hs-linenum> 14: </span><span class='hs-comment'>--   , fromList</span>
<span class=hs-linenum> 15: </span><span class='hs-comment'>--   -- * Converting to a list</span>
<span class=hs-linenum> 16: </span><span class='hs-comment'>--   , toList</span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>--   -- * Deleting</span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>--   , deleteMin</span>
<span class=hs-linenum> 19: </span><span class='hs-comment'>--   -- * Checking heaps</span>
<span class=hs-linenum> 20: </span><span class='hs-comment'>--   , null</span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>--   -- * Helper functions</span>
<span class=hs-linenum> 22: </span><span class='hs-comment'>--   , merge</span>
<span class=hs-linenum> 23: </span><span class='hs-comment'>--   , minimum</span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>--   , valid</span>
<span class=hs-linenum> 25: </span><span class='hs-comment'>--   , heapSort</span>
<span class=hs-linenum> 26: </span><span class='hs-comment'>--   ) where</span>
<span class=hs-linenum> 27: </span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Applicative</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.List</span> <span class='hs-layout'>(</span><span class='hs-varid'>foldl'</span><span class='hs-layout'>,</span> <span class='hs-varid'>unfoldr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 30: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>minimum</span><span class='hs-layout'>,</span> <span class='hs-varid'>maximum</span><span class='hs-layout'>,</span> <span class='hs-varid'>null</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 32: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Set</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>S</span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Set</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum> 36: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>n</span> <span class='hs-conop'>:</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>X</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>n</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node</span> <span class='hs-layout'>(</span><span class='hs-varid'>root</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>left</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span> <span class='hs-varid'>root</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>right</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span> <span class='hs-varid'>root</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 38: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Show</span>
<span class=hs-linenum> 39: </span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-comment'>-- -- instance (Eq a, Ord a) =&gt; Eq (Skew a) where</span>
<span class=hs-linenum> 42: </span><span class='hs-comment'>-- --     h1 == h2 = heapSort h1 == heapSort h2</span>
<span class=hs-linenum> 43: </span>
<span class=hs-linenum> 44: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum> 45: </span>
<span class=hs-linenum> 46: </span><span class='hs-comment'>-- -- {-| Empty heap.</span>
<span class=hs-linenum> 47: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum> 48: </span>
<span class=hs-linenum> 49: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = 0 &amp;&amp; elts r = S.empty}</span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 50: </span><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 51: </span><a class=annot href="#"><span class=annottext>forall a .
{r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == 0
                               &amp;&amp; Data.Heap.Skew.elts r == Set_empty 0}</span><span class='hs-definition'>empty</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span>
<span class=hs-linenum> 52: </span>
<span class=hs-linenum> 53: </span><span class='hs-comment'>-- -- {-|</span>
<span class=hs-linenum> 54: </span><span class='hs-comment'>-- -- See if the heap is empty.</span>
<span class=hs-linenum> 55: </span>
<span class=hs-linenum> 56: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; Data.Heap.Skew.null empty</span>
<span class=hs-linenum> 57: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum> 58: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; Data.Heap.Skew.null (singleton 1)</span>
<span class=hs-linenum> 59: </span><span class='hs-comment'>-- -- False</span>
<span class=hs-linenum> 60: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span><span class='hs-comment'>-- -- null :: Skew t -&gt; Bool</span>
<span class=hs-linenum> 63: </span><span class='hs-comment'>-- -- null Leaf         = True</span>
<span class=hs-linenum> 64: </span><span class='hs-comment'>-- -- null (Node _ _ _) = False</span>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span><span class='hs-comment'>-- -- {-| Singleton heap.</span>
<span class=hs-linenum> 67: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum> 68: </span>
<span class=hs-linenum> 69: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = 1 &amp;&amp; elts r = S.singleton x }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 70: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 71: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1184:a -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == 1
                                                   &amp;&amp; Data.Heap.Skew.elts r == Set_sng lq_tmp$x##1184}</span><span class='hs-definition'>singleton</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Node</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1217 : a | lq_tmp$x##1217 == x##a2rM}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1187 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.elts lq_tmp$x##1187 == Set_empty 0
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##1187 == 0}</span><span class='hs-conid'>Leaf</span></a> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1194 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.elts lq_tmp$x##1194 == Set_empty 0
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##1194 == 0}</span><span class='hs-conid'>Leaf</span></a>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum> 74: </span>
<span class=hs-linenum> 75: </span><span class='hs-comment'>-- -- {-| Insertion.</span>
<span class=hs-linenum> 76: </span>
<span class=hs-linenum> 77: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; insert 7 (fromList [5,3]) == fromList [3,5,7]</span>
<span class=hs-linenum> 78: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum> 79: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; insert 5 empty            == singleton 5</span>
<span class=hs-linenum> 80: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum> 81: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum> 82: </span>
<span class=hs-linenum> 83: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = 1 + size s &amp;&amp; elts r = S.union (elts s) (S.singleton x)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 84: </span><span class='hs-definition'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 85: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##2785:a -&gt; lq_tmp$x##2786:(Data.Heap.Skew.Skew a) -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == 1 + Data.Heap.Skew.size lq_tmp$x##2786
                                                                                             &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts lq_tmp$x##2786) (Set_sng lq_tmp$x##2785)}</span><span class='hs-definition'>insert</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(Data.Heap.Skew.Skew a)</span><span class='hs-varid'>t</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>merge</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2792 : (Data.Heap.Skew.Skew {lq_tmp$x##2798 : a^"lq_tmp$x##2797" | $k_##2796[VV##2795:=lq_tmp$x##2798][lq_tmp$x##2794:=x##a2rN]}) | Data.Heap.Skew.size lq_tmp$x##2792 == 1
                                                                                                                                               &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2792 == Set_sng x##a2rN}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>singleton</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2799 : a | lq_tmp$x##2799 == x##a2rN}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2824 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##2824 &gt;= 0
                                            &amp;&amp; lq_tmp$x##2824 == t##a2rO}</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum> 86: </span>
<span class=hs-linenum> 87: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum> 88: </span>
<span class=hs-linenum> 89: </span><span class='hs-comment'>-- -- {-| Creating a heap from a list.</span>
<span class=hs-linenum> 90: </span>
<span class=hs-linenum> 91: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; empty == fromList []</span>
<span class=hs-linenum> 92: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum> 93: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; singleton 'a' == fromList ['a']</span>
<span class=hs-linenum> 94: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum> 95: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; fromList [5,3] == fromList [5,3]</span>
<span class=hs-linenum> 96: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum> 97: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum> 98: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = len l &amp;&amp; elts r = S.fromList l}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 99: </span><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>100: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##2846:[a] -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == len lq_tmp$x##2846
                                                     &amp;&amp; Data.Heap.Skew.elts r == listElts lq_tmp$x##2846}</span><span class='hs-definition'>fromList</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##2874 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.elts lq_tmp$x##2874 == Set_empty 0
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2874 == 0}</span><span class='hs-conid'>Leaf</span></a>
<span class=hs-linenum>101: </span><span class='hs-definition'>fromList</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2959 : (GHC.Classes.Ord a) | lq_tmp$x##2959 == $dOrd_a3cr}</span><span class='hs-varid'>insert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2960 : a | lq_tmp$x##2960 == x##a2rP}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2922 : (Data.Heap.Skew.Skew {lq_tmp$x##2932 : a^"lq_tmp$x##2931" | $k_##2930[VV##2929:=lq_tmp$x##2932][lq_tmp$x##2926:=fix$36$$36$dOrd_a3cr][lq_tmp$x##2927:=xs##a2rQ]}) | Data.Heap.Skew.size lq_tmp$x##2922 == len xs##a2rQ
                                                                                                                                                                                      &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2922 == listElts xs##a2rQ}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromList</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2938 : [a] | len lq_tmp$x##2938 &gt;= 0
                        &amp;&amp; lq_tmp$x##2938 == xs##a2rQ}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>104: </span>
<span class=hs-linenum>105: </span><span class='hs-comment'>-- -- {-| Creating a list from a heap. O(N)</span>
<span class=hs-linenum>106: </span>
<span class=hs-linenum>107: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; let xs = [5,3,5]</span>
<span class=hs-linenum>108: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; length (toList (fromList xs)) == length xs</span>
<span class=hs-linenum>109: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum>110: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; toList empty</span>
<span class=hs-linenum>111: </span><span class='hs-comment'>-- -- []</span>
<span class=hs-linenum>112: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum>113: </span>
<span class=hs-linenum>114: </span><span class='hs-comment'>-- {-@ app :: l1:[a] -&gt; l2:[a] -&gt; {r: [a] | eltsList r = S.union (eltsList l1) (eltsList l2)} @-}</span>
<span class=hs-linenum>115: </span><span class='hs-comment'>-- app :: [a] -&gt; [a] -&gt; [a]</span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- app [] l2 = l2</span>
<span class=hs-linenum>117: </span><span class='hs-comment'>-- app (x:t) l2 = x : (app t l2)</span>
<span class=hs-linenum>118: </span>
<span class=hs-linenum>119: </span><span class='hs-comment'>-- {-@ toList :: s:(Skew a) -&gt;  {l: [a] | len l = size s &amp;&amp; elts s = eltsList l} @-}</span>
<span class=hs-linenum>120: </span><span class='hs-comment'>-- toList :: Skew a -&gt; [a]</span>
<span class=hs-linenum>121: </span><span class='hs-comment'>-- toList Leaf = []</span>
<span class=hs-linenum>122: </span><span class='hs-comment'>-- toList (Node x l r) = app (toList l) (x : (toList r))</span>
<span class=hs-linenum>123: </span>    
<span class=hs-linenum>124: </span><span class='hs-comment'>--      inorder t []</span>
<span class=hs-linenum>125: </span><span class='hs-comment'>--   where</span>
<span class=hs-linenum>126: </span><span class='hs-comment'>--     inorder Leaf xs         = xs</span>
<span class=hs-linenum>127: </span><span class='hs-comment'>--     inorder (Node x l r) xs = inorder l (x : inorder r xs)</span>
<span class=hs-linenum>128: </span>
<span class=hs-linenum>129: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>130: </span>
<span class=hs-linenum>131: </span><span class='hs-comment'>-- -- {-| Finding the minimum element.</span>
<span class=hs-linenum>132: </span>
<span class=hs-linenum>133: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; minimum (fromList [3,5,1])</span>
<span class=hs-linenum>134: </span><span class='hs-comment'>-- -- Just 1</span>
<span class=hs-linenum>135: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; minimum empty</span>
<span class=hs-linenum>136: </span><span class='hs-comment'>-- -- Nothing</span>
<span class=hs-linenum>137: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum>138: </span>
<span class=hs-linenum>139: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bounded</span> <span class='hs-conid'>Int</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>140: </span>
<span class=hs-linenum>141: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>size</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>142: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>143: </span><span class='hs-definition'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>144: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1226:(Data.Heap.Skew.Skew a) -&gt; {VV : GHC.Types.Int | VV == Data.Heap.Skew.size lq_tmp$x##1226
                                                                &amp;&amp; VV &gt;= 0}</span><span class='hs-definition'>size</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1240 : GHC.Prim.Int# | lq_tmp$x##1240 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>145: </span><span class='hs-definition'>size</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1280 : GHC.Types.Int | lq_tmp$x##1280 == lq_anf$##7205759403792806323##d3jd}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1287 : GHC.Types.Int | lq_tmp$x##1287 == Data.Heap.Skew.size l##a2rR
                                  &amp;&amp; lq_tmp$x##1287 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1295 : (Data.Heap.Skew.Skew {lq_tmp$x##1294 : a | ds_d3it &lt;= lq_tmp$x##1294}) | lq_tmp$x##1295 == l##a2rR}</span><span class='hs-varid'>l</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1317 : GHC.Types.Int | lq_tmp$x##1317 == Data.Heap.Skew.size r##a2rS
                                  &amp;&amp; lq_tmp$x##1317 &gt;= 0}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1325 : (Data.Heap.Skew.Skew {lq_tmp$x##1324 : a | ds_d3it &lt;= lq_tmp$x##1324}) | lq_tmp$x##1325 == r##a2rS}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>146: </span>
<span class=hs-linenum>147: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>minimum</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>148: </span><span class='hs-keyword'>{-@</span><span class='hs-definition'>minimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{s:</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>149: </span><span class='hs-definition'>minimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>150: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1347:{VV : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size VV} -&gt; {VV : a | VV == Data.Heap.Skew.minimum lq_tmp$x##1347}</span><span class='hs-definition'>minimum</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1405 : a | lq_tmp$x##1405 == x##a2tM}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>151: </span>
<span class=hs-linenum>152: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>153: </span>
<span class=hs-linenum>154: </span><span class='hs-comment'>-- -- {-| Deleting the minimum element.</span>
<span class=hs-linenum>155: </span>
<span class=hs-linenum>156: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; deleteMin (fromList [5,3,7]) == fromList [5,7]</span>
<span class=hs-linenum>157: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum>158: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; deleteMin empty == empty</span>
<span class=hs-linenum>159: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum>160: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum>161: </span>
<span class=hs-linenum>162: </span><span class='hs-keyword'>{-@</span><span class='hs-definition'>deleteMin</span> <span class='hs-keyglyph'>::</span>  <span class='hs-keyword'>{s:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r + 1 = size s}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>163: </span><span class='hs-definition'>deleteMin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>164: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##2655:{s : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size s} -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r + 1 == Data.Heap.Skew.size lq_tmp$x##2655}</span><span class='hs-definition'>deleteMin</span></a> <a class=annot href="#"><span class=annottext>{s : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size s}</span><span class='hs-varid'>t</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b .
lq_tmp$x##2751:(a, b) -&gt; {lq_tmp$x##2748 : b | lq_tmp$x##2748 == snd lq_tmp$x##2751}</span><span class='hs-varid'>snd</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2728 : ({lq_tmp$x##2737 : a^"lq_tmp$x##2736" | $k_##2735[VV##2734:=lq_tmp$x##2737][lq_tmp$x##2731:=fix$36$$36$dOrd_a3bI][lq_tmp$x##2732:=lq_anf$##7205759403792806362##d3jQ]}, (Data.Heap.Skew.Skew {lq_tmp$x##2737 : a^"lq_tmp$x##2736" | $k_##2735[VV##2734:=lq_tmp$x##2737][lq_tmp$x##2731:=fix$36$$36$dOrd_a3bI][lq_tmp$x##2732:=lq_anf$##7205759403792806362##d3jQ]
                                                                                                                                                                                                                                                      &amp;&amp; fst lq_tmp$x##2728 &lt;= lq_tmp$x##2737})) | Data.Heap.Skew.size (snd lq_tmp$x##2728) + 1 == Data.Heap.Skew.size lq_anf$##7205759403792806362##d3jQ
                                                                                                                                                                                                                                                                                                   &amp;&amp; Set_cup (Data.Heap.Skew.elts (snd lq_tmp$x##2728)) (Set_sng (fst lq_tmp$x##2728)) == Data.Heap.Skew.elts lq_anf$##7205759403792806362##d3jQ}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>deleteMin2</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2741 : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size lq_tmp$x##2741
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2741 &gt;= 0
                                            &amp;&amp; lq_tmp$x##2741 == t##a2tN
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2741 &gt;= 0
                                            &amp;&amp; Data.Heap.Skew.right lq_tmp$x##2741 == ds_d3i5
                                            &amp;&amp; Data.Heap.Skew.left lq_tmp$x##2741 == ds_d3i4
                                            &amp;&amp; Data.Heap.Skew.root lq_tmp$x##2741 == ds_d3i3
                                            &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2741 == Set_cup (Set_cup (Set_sng ds_d3i3) (Data.Heap.Skew.elts ds_d3i4)) (Data.Heap.Skew.elts ds_d3i5)
                                            &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##2741 == ds_d3i3
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2741 == (1 + Data.Heap.Skew.size ds_d3i4) + Data.Heap.Skew.size ds_d3i5
                                            &amp;&amp; lq_tmp$x##2741 == Data.Heap.Skew.Node ds_d3i3 ds_d3i4 ds_d3i5
                                            &amp;&amp; Data.Heap.Skew.right lq_tmp$x##2741 == ds_d3i5
                                            &amp;&amp; Data.Heap.Skew.left lq_tmp$x##2741 == ds_d3i4
                                            &amp;&amp; Data.Heap.Skew.root lq_tmp$x##2741 == ds_d3i3
                                            &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2741 == Set_cup (Set_cup (Set_sng ds_d3i3) (Data.Heap.Skew.elts ds_d3i4)) (Data.Heap.Skew.elts ds_d3i5)
                                            &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##2741 == ds_d3i3
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2741 == (1 + Data.Heap.Skew.size ds_d3i4) + Data.Heap.Skew.size ds_d3i5
                                            &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2741 &gt;= 0
                                            &amp;&amp; lq_tmp$x##2741 == lq_anf$##7205759403792806362##d3jQ}</span><span class='hs-varid'>t</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>165: </span>
<span class=hs-linenum>166: </span><span class='hs-comment'>--difference property does not work because the min could appear multiple times in the heap</span>
<span class=hs-linenum>167: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>deleteMin2</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{s:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-keyword'>{x:</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| fst(r) &lt;= x}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| size (snd r) + 1 = size s &amp;&amp; S.union (elts (snd r)) (S.singleton (fst r)) = elts s}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>168: </span><span class='hs-definition'>deleteMin2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>169: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##2258:{s : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size s} -&gt; {r : (a, (Data.Heap.Skew.Skew {VV : a | fst r &lt;= VV})) | Data.Heap.Skew.size (snd r) + 1 == Data.Heap.Skew.size lq_tmp$x##2258
                                                                                                                                     &amp;&amp; Set_cup (Data.Heap.Skew.elts (snd r)) (Set_sng (fst r)) == Data.Heap.Skew.elts lq_tmp$x##2258}</span><span class='hs-definition'>deleteMin2</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>x</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a b &lt;p2 :: a b -&gt; Bool&gt; .
lq_tmp$x##2374:a -&gt; lq_tmp$x##2375:{lq_tmp$x##2366 : b&lt;p2 lq_tmp$x##2374&gt; | true} -&gt; {lq_tmp$x##2371 : (a, b)&lt;\lq_tmp$x##2376 VV -&gt; {lq_tmp$x##2370 : b&lt;p2 lq_tmp$x##2376&gt; | true}&gt; | x_Tuple22 lq_tmp$x##2371 == lq_tmp$x##2375
                                                                                                                                                                                      &amp;&amp; x_Tuple21 lq_tmp$x##2371 == lq_tmp$x##2374
                                                                                                                                                                                      &amp;&amp; snd lq_tmp$x##2371 == lq_tmp$x##2375
                                                                                                                                                                                      &amp;&amp; fst lq_tmp$x##2371 == lq_tmp$x##2374}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2397 : a | lq_tmp$x##2397 == x##a2u4}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2347 : (Data.Heap.Skew.Skew {lq_tmp$x##2357 : a^"lq_tmp$x##2356" | $k_##2355[VV##2354:=lq_tmp$x##2357][lq_tmp$x##2351:=fix$36$$36$dOrd_a39f][lq_tmp$x##2352:=l##a2u5][lq_tmp$x##2353:=r##a2u6]}) | Data.Heap.Skew.size lq_tmp$x##2347 == Data.Heap.Skew.size l##a2u5 + Data.Heap.Skew.size r##a2u6
                                                                                                                                                                                                              &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2347 == Set_cup (Data.Heap.Skew.elts l##a2u5) (Data.Heap.Skew.elts r##a2u6)}</span><span class='hs-varid'>merge</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2361 : (Data.Heap.Skew.Skew {lq_tmp$x##2360 : a | x##a2u4 &lt;= lq_tmp$x##2360}) | Data.Heap.Skew.size lq_tmp$x##2361 &gt;= 0
                                                                                           &amp;&amp; lq_tmp$x##2361 == l##a2u5}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2363 : (Data.Heap.Skew.Skew {lq_tmp$x##2362 : a | x##a2u4 &lt;= lq_tmp$x##2362}) | Data.Heap.Skew.size lq_tmp$x##2363 &gt;= 0
                                                                                           &amp;&amp; lq_tmp$x##2363 == r##a2u6}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>170: </span>
<span class=hs-linenum>171: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>172: </span><span class='hs-comment'>-- -- {-| Merging two heaps</span>
<span class=hs-linenum>173: </span>
<span class=hs-linenum>174: </span><span class='hs-comment'>-- -- &gt;&gt;&gt; merge (fromList [5,3]) (fromList [5,7]) == fromList [3,5,5,7]</span>
<span class=hs-linenum>175: </span><span class='hs-comment'>-- -- True</span>
<span class=hs-linenum>176: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum>177: </span>
<span class=hs-linenum>178: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>elts</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>179: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>elts</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>180: </span><span class='hs-definition'>elts</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>181: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1411:(Data.Heap.Skew.Skew a) -&gt; {VV : (Data.Set.Internal.Set a) | VV == Data.Heap.Skew.elts lq_tmp$x##1411}</span><span class='hs-definition'>elts</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1427 : (Data.Set.Internal.Set a) | Set_emp lq_tmp$x##1427}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum>182: </span><span class='hs-definition'>elts</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1555 : (GHC.Classes.Ord a) | lq_tmp$x##1555 == $dOrd_a391}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1499 : (Data.Set.Internal.Set {lq_tmp$x##1509 : a^"lq_tmp$x##1508" | $k_##1507[VV##1506:=lq_tmp$x##1509][lq_tmp$x##1503:=fix$36$$36$dOrd_a391][lq_tmp$x##1504:=lq_anf$##7205759403792806331##d3jl][lq_tmp$x##1505:=lq_anf$##7205759403792806332##d3jm]}) | lq_tmp$x##1499 == Set_cup lq_anf$##7205759403792806331##d3jl lq_anf$##7205759403792806332##d3jm}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.union</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1464 : (Data.Set.Internal.Set {lq_tmp$x##1470 : a^"lq_tmp$x##1469" | $k_##1468[VV##1467:=lq_tmp$x##1470][lq_tmp$x##1466:=rt##a2u7]}) | lq_tmp$x##1464 == Set_sng rt##a2u7}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.singleton</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1471 : a | lq_tmp$x##1471 == rt##a2u7}</span><span class='hs-varid'>rt</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1478 : (Data.Set.Internal.Set {lq_tmp$x##1486 : a^"lq_tmp$x##1485" | $k_##1484[VV##1483:=lq_tmp$x##1486][lq_tmp$x##1481:=fix$36$$36$dOrd_a391][lq_tmp$x##1482:=l##a2u8]}) | lq_tmp$x##1478 == Data.Heap.Skew.elts l##a2u8}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>elts</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1490 : (Data.Heap.Skew.Skew {lq_tmp$x##1489 : a | rt##a2u7 &lt;= lq_tmp$x##1489}) | Data.Heap.Skew.size lq_tmp$x##1490 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##1490 == l##a2u8}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1522 : (Data.Set.Internal.Set {lq_tmp$x##1530 : a^"lq_tmp$x##1529" | $k_##1528[VV##1527:=lq_tmp$x##1530][lq_tmp$x##1525:=fix$36$$36$dOrd_a391][lq_tmp$x##1526:=r##a2u9]}) | lq_tmp$x##1522 == Data.Heap.Skew.elts r##a2u9}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>elts</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1534 : (Data.Heap.Skew.Skew {lq_tmp$x##1533 : a | rt##a2u7 &lt;= lq_tmp$x##1533}) | Data.Heap.Skew.size lq_tmp$x##1534 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##1534 == r##a2u9}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>183: </span>
<span class=hs-linenum>184: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>eltsList</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>185: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>eltsList</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>186: </span><span class='hs-definition'>eltsList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span> 
<span class=hs-linenum>187: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1572:[a] -&gt; {VV : (Data.Set.Internal.Set a) | VV == Data.Heap.Skew.eltsList lq_tmp$x##1572}</span><span class='hs-definition'>eltsList</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
{lq_tmp$x##1600 : (Data.Set.Internal.Set a) | Set_emp lq_tmp$x##1600}</span><span class='hs-conid'>S.empty</span></a>
<span class=hs-linenum>188: </span><span class='hs-definition'>eltsList</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1697 : (GHC.Classes.Ord a) | lq_tmp$x##1697 == $dOrd_a38O}</span><span class='hs-conid'>S.union</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1643 : (Data.Set.Internal.Set {lq_tmp$x##1649 : a^"lq_tmp$x##1648" | $k_##1647[VV##1646:=lq_tmp$x##1649][lq_tmp$x##1645:=x##a2ua]}) | lq_tmp$x##1643 == Set_sng x##a2ua}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>S.singleton</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1650 : a | lq_tmp$x##1650 == x##a2ua}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1659 : (Data.Set.Internal.Set {lq_tmp$x##1669 : a^"lq_tmp$x##1668" | $k_##1667[VV##1666:=lq_tmp$x##1669][lq_tmp$x##1663:=fix$36$$36$dOrd_a38O][lq_tmp$x##1664:=xs##a2ub]}) | lq_tmp$x##1659 == Data.Heap.Skew.eltsList xs##a2ub}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>eltsList</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1675 : [a] | len lq_tmp$x##1675 &gt;= 0
                        &amp;&amp; lq_tmp$x##1675 == xs##a2ub}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>189: </span>
<span class=hs-linenum>190: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>EqElts</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>Y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>191: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>HeapS</span> <span class='hs-varid'>a</span> <span class='hs-conid'>S</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>elts</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>192: </span><span class='hs-comment'>--{-@ type HeapUn R X Y = EqElts (elts R) (S.union (elts X) (elts Y)) @-}</span>
<span class=hs-linenum>193: </span>
<span class=hs-linenum>194: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assert</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>Bool</span> <span class='hs-keyword'>| v}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>195: </span><span class='hs-definition'>assert</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>196: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1714:{v : GHC.Types.Bool | v} -&gt; lq_tmp$x##1715:a -&gt; a</span><span class='hs-definition'>assert</span></a> <span class='hs-keyword'>_</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>197: </span>
<span class=hs-linenum>198: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>skewBoundedByRoot</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{s:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| 0 &lt; size s}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r :</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>minimum</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| size s = size r &amp;&amp; EqElts s r}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>199: </span><span class='hs-definition'>skewBoundedByRoot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>200: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1726:{VV : (Data.Heap.Skew.Skew a) | 0 &lt; Data.Heap.Skew.size VV} -&gt; {r : (Data.Heap.Skew.Skew {VV : a | Data.Heap.Skew.minimum lq_tmp$x##1726 &lt;= VV}) | Data.Heap.Skew.size lq_tmp$x##1726 == Data.Heap.Skew.size r
                                                                                                                                                                  &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##1726 == Data.Heap.Skew.elts r}</span><span class='hs-definition'>skewBoundedByRoot</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1798:a -&gt; lq_tmp$x##1799:(Data.Heap.Skew.Skew {lq_tmp$x##1789 : a | lq_tmp$x##1798 &lt;= lq_tmp$x##1789}) -&gt; lq_tmp$x##1800:(Data.Heap.Skew.Skew {lq_tmp$x##1791 : a | lq_tmp$x##1798 &lt;= lq_tmp$x##1791}) -&gt; {lq_tmp$x##1794 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.right lq_tmp$x##1794 == lq_tmp$x##1800
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.left lq_tmp$x##1794 == lq_tmp$x##1799
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.root lq_tmp$x##1794 == lq_tmp$x##1798
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##1794 == Set_cup (Set_cup (Set_sng lq_tmp$x##1798) (Data.Heap.Skew.elts lq_tmp$x##1799)) (Data.Heap.Skew.elts lq_tmp$x##1800)
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##1794 == lq_tmp$x##1798
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.size lq_tmp$x##1794 == (1 + Data.Heap.Skew.size lq_tmp$x##1799) + Data.Heap.Skew.size lq_tmp$x##1800}</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1805 : a | lq_tmp$x##1805 == rt##a2ud}</span><span class='hs-varid'>rt</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1807 : (Data.Heap.Skew.Skew {lq_tmp$x##1806 : a | rt##a2ud &lt;= lq_tmp$x##1806}) | Data.Heap.Skew.size lq_tmp$x##1807 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##1807 == l##a2ue}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1809 : (Data.Heap.Skew.Skew {lq_tmp$x##1808 : a | rt##a2ud &lt;= lq_tmp$x##1808}) | Data.Heap.Skew.size lq_tmp$x##1809 &gt;= 0
                                                                                            &amp;&amp; lq_tmp$x##1809 == r##a2uf}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>201: </span>
<span class=hs-linenum>202: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>boundedSkewTransitive</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{y:</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| y &lt;= x}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r :</span> <span class='hs-conid'>Skew</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span> <span class='hs-varid'>a</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| size s = size r &amp;&amp; EqElts s r}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>203: </span><span class='hs-definition'>boundedSkewTransitive</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>204: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1815:a -&gt; lq_tmp$x##1816:(Data.Heap.Skew.Skew {VV : a | lq_tmp$x##1815 &lt;= VV}) -&gt; lq_tmp$x##1817:{VV : a | VV &lt;= lq_tmp$x##1815} -&gt; {r : (Data.Heap.Skew.Skew {VV : a | lq_tmp$x##1817 &lt;= VV}) | Data.Heap.Skew.size lq_tmp$x##1816 == Data.Heap.Skew.size r
                                                                                                                                                                                                           &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##1816 == Data.Heap.Skew.elts r}</span><span class='hs-definition'>boundedSkewTransitive</span></a> <span class='hs-keyword'>_</span> <a class=annot href="#"><span class=annottext>(Data.Heap.Skew.Skew {VV : a | ds_d3gr &lt;= VV})</span><span class='hs-varid'>s</span></a> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>s</span>
<span class=hs-linenum>205: </span>
<span class=hs-linenum>206: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>merge</span> <span class='hs-keyglyph'>::</span><span class='hs-varid'>t1</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t2</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{r:</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size r = size t1 + size t2 &amp;&amp; ((elts r) = (S.union (elts t1) (elts t2)))}</span>  <span class='hs-varop'>/</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>t1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>size</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>207: </span><span class='hs-definition'>merge</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>208: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1845:(Data.Heap.Skew.Skew a) -&gt; lq_tmp$x##1846:(Data.Heap.Skew.Skew a) -&gt; {r : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size r == Data.Heap.Skew.size lq_tmp$x##1845 + Data.Heap.Skew.size lq_tmp$x##1846
                                                                                                                   &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts lq_tmp$x##1845) (Data.Heap.Skew.elts lq_tmp$x##1846)}</span><span class='hs-definition'>merge</span></a> <a class=annot href="#"><span class=annottext>(Data.Heap.Skew.Skew a)</span><span class='hs-varid'>t1</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1863 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##1863 &gt;= 0
                                            &amp;&amp; lq_tmp$x##1863 == t1##a2uh}</span><span class='hs-varid'>t1</span></a>
<span class=hs-linenum>209: </span><span class='hs-definition'>merge</span> <span class='hs-conid'>Leaf</span> <span class='hs-varid'>t2</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1906 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##1906 &gt;= 0
                                            &amp;&amp; lq_tmp$x##1906 == ds_d3gF}</span><span class='hs-varid'>t2</span></a>
<span class=hs-linenum>210: </span><span class='hs-definition'>merge</span> <span class='hs-varid'>t1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt1</span> <span class='hs-varid'>l1</span> <span class='hs-varid'>r1</span><span class='hs-layout'>)</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>rt2</span> <span class='hs-varid'>l2</span> <span class='hs-varid'>r2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>211: </span>    <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2014 : a | lq_tmp$x##2014 == rt1##a2uk}</span><span class='hs-varid'>rt1</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2015 : a | lq_tmp$x##2015 == rt2##a2uo}</span><span class='hs-varid'>rt2</span></a> <span class='hs-keyword'>then</span>
<span class=hs-linenum>212: </span>        <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2225:a -&gt; lq_tmp$x##2226:(Data.Heap.Skew.Skew {lq_tmp$x##2216 : a | lq_tmp$x##2225 &lt;= lq_tmp$x##2216}) -&gt; lq_tmp$x##2227:(Data.Heap.Skew.Skew {lq_tmp$x##2218 : a | lq_tmp$x##2225 &lt;= lq_tmp$x##2218}) -&gt; {lq_tmp$x##2221 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.right lq_tmp$x##2221 == lq_tmp$x##2227
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.left lq_tmp$x##2221 == lq_tmp$x##2226
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.root lq_tmp$x##2221 == lq_tmp$x##2225
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2221 == Set_cup (Set_cup (Set_sng lq_tmp$x##2225) (Data.Heap.Skew.elts lq_tmp$x##2226)) (Data.Heap.Skew.elts lq_tmp$x##2227)
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##2221 == lq_tmp$x##2225
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2221 == (1 + Data.Heap.Skew.size lq_tmp$x##2226) + Data.Heap.Skew.size lq_tmp$x##2227}</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2232 : a | lq_tmp$x##2232 == rt1##a2uk}</span><span class='hs-varid'>rt1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2234 : (Data.Heap.Skew.Skew {lq_tmp$x##2233 : a | rt1##a2uk &lt;= lq_tmp$x##2233}) | Data.Heap.Skew.size lq_tmp$x##2234 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2234 == r1##a2um}</span><span class='hs-varid'>r1</span></a> <a class=annot href="#"><span class=annottext>{r : (Data.Heap.Skew.Skew {lq_tmp$x##2207 : a^"lq_tmp$x##2206" | $k_##2205[VV##2204:=lq_tmp$x##2207][lq_tmp$x##1844:=fix$36$$36$dOrd_a38u][lq_tmp$x##1845:=l1##a2ul][lq_tmp$x##1846:=lq_anf$##7205759403792806352##d3jG]}) | Data.Heap.Skew.size r == Data.Heap.Skew.size l1##a2ul + Data.Heap.Skew.size lq_anf$##7205759403792806352##d3jG
                                                                                                                                                                                                                             &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts l1##a2ul) (Data.Heap.Skew.elts lq_anf$##7205759403792806352##d3jG)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>merge</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2211 : (Data.Heap.Skew.Skew {lq_tmp$x##2210 : a | rt1##a2uk &lt;= lq_tmp$x##2210}) | Data.Heap.Skew.size lq_tmp$x##2211 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2211 == l1##a2ul}</span><span class='hs-varid'>l1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2174 : (Data.Heap.Skew.Skew {lq_tmp$x##2184 : a^"lq_tmp$x##2183" | $k_##2182[VV##2181:=lq_tmp$x##2184][lq_tmp$x##2178:=rt2##a2uo][lq_tmp$x##2179:=lq_anf$##7205759403792806351##d3jF][lq_tmp$x##2180:=rt1##a2uk]
                                                                              &amp;&amp; rt1##a2uk &lt;= lq_tmp$x##2184}) | Data.Heap.Skew.size lq_anf$##7205759403792806351##d3jF == Data.Heap.Skew.size lq_tmp$x##2174
                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806351##d3jF == Data.Heap.Skew.elts lq_tmp$x##2174}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>boundedSkewTransitive</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2185 : a | lq_tmp$x##2185 == rt2##a2uo}</span><span class='hs-varid'>rt2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2159 : (Data.Heap.Skew.Skew {lq_tmp$x##2165 : a^"lq_tmp$x##2164" | $k_##2163[VV##2162:=lq_tmp$x##2165][lq_tmp$x##2161:=lq_anf$##7205759403792806350##d3jE]
                                                                              &amp;&amp; Data.Heap.Skew.minimum lq_anf$##7205759403792806350##d3jE &lt;= lq_tmp$x##2165}) | Data.Heap.Skew.size lq_anf$##7205759403792806350##d3jE == Data.Heap.Skew.size lq_tmp$x##2159
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806350##d3jE == Data.Heap.Skew.elts lq_tmp$x##2159}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>skewBoundedByRoot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2139 : (Data.Heap.Skew.Skew {lq_tmp$x##2149 : a^"lq_tmp$x##2148" | $k_##2147[VV##2146:=lq_tmp$x##2149][lq_tmp$x##2143:=rt2##a2uo][lq_tmp$x##2144:=l2##a2up][lq_tmp$x##2145:=r2##a2uq]}) | Data.Heap.Skew.right lq_tmp$x##2139 == r2##a2uq
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.left lq_tmp$x##2139 == l2##a2up
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.root lq_tmp$x##2139 == rt2##a2uo
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2139 == Set_cup (Set_cup (Set_sng rt2##a2uo) (Data.Heap.Skew.elts l2##a2up)) (Data.Heap.Skew.elts r2##a2uq)
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##2139 == rt2##a2uo
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2139 == (1 + Data.Heap.Skew.size l2##a2up) + Data.Heap.Skew.size r2##a2uq}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Node</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2150 : a | lq_tmp$x##2150 == rt2##a2uo}</span><span class='hs-varid'>rt2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2152 : (Data.Heap.Skew.Skew {lq_tmp$x##2151 : a | rt2##a2uo &lt;= lq_tmp$x##2151}) | Data.Heap.Skew.size lq_tmp$x##2152 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2152 == l2##a2up}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2154 : (Data.Heap.Skew.Skew {lq_tmp$x##2153 : a | rt2##a2uo &lt;= lq_tmp$x##2153}) | Data.Heap.Skew.size lq_tmp$x##2154 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2154 == r2##a2uq}</span><span class='hs-varid'>r2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2188 : a | lq_tmp$x##2188 == rt1##a2uk}</span><span class='hs-varid'>rt1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> 
<span class=hs-linenum>213: </span>    <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2116:a -&gt; lq_tmp$x##2117:(Data.Heap.Skew.Skew {lq_tmp$x##2107 : a | lq_tmp$x##2116 &lt;= lq_tmp$x##2107}) -&gt; lq_tmp$x##2118:(Data.Heap.Skew.Skew {lq_tmp$x##2109 : a | lq_tmp$x##2116 &lt;= lq_tmp$x##2109}) -&gt; {lq_tmp$x##2112 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.right lq_tmp$x##2112 == lq_tmp$x##2118
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.left lq_tmp$x##2112 == lq_tmp$x##2117
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.root lq_tmp$x##2112 == lq_tmp$x##2116
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2112 == Set_cup (Set_cup (Set_sng lq_tmp$x##2116) (Data.Heap.Skew.elts lq_tmp$x##2117)) (Data.Heap.Skew.elts lq_tmp$x##2118)
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##2112 == lq_tmp$x##2116
                                                                                                                                                                                                                                                                &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2112 == (1 + Data.Heap.Skew.size lq_tmp$x##2117) + Data.Heap.Skew.size lq_tmp$x##2118}</span><span class='hs-conid'>Node</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2123 : a | lq_tmp$x##2123 == rt2##a2uo}</span><span class='hs-varid'>rt2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2125 : (Data.Heap.Skew.Skew {lq_tmp$x##2124 : a | rt2##a2uo &lt;= lq_tmp$x##2124}) | Data.Heap.Skew.size lq_tmp$x##2125 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2125 == r2##a2uq}</span><span class='hs-varid'>r2</span></a> <a class=annot href="#"><span class=annottext>{r : (Data.Heap.Skew.Skew {lq_tmp$x##2098 : a^"lq_tmp$x##2097" | $k_##2096[VV##2095:=lq_tmp$x##2098][lq_tmp$x##1844:=fix$36$$36$dOrd_a38u][lq_tmp$x##1845:=l2##a2up][lq_tmp$x##1846:=lq_anf$##7205759403792806348##d3jC]}) | Data.Heap.Skew.size r == Data.Heap.Skew.size l2##a2up + Data.Heap.Skew.size lq_anf$##7205759403792806348##d3jC
                                                                                                                                                                                                                             &amp;&amp; Data.Heap.Skew.elts r == Set_cup (Data.Heap.Skew.elts l2##a2up) (Data.Heap.Skew.elts lq_anf$##7205759403792806348##d3jC)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>merge</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2102 : (Data.Heap.Skew.Skew {lq_tmp$x##2101 : a | rt2##a2uo &lt;= lq_tmp$x##2101}) | Data.Heap.Skew.size lq_tmp$x##2102 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2102 == l2##a2up}</span><span class='hs-varid'>l2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2065 : (Data.Heap.Skew.Skew {lq_tmp$x##2075 : a^"lq_tmp$x##2074" | $k_##2073[VV##2072:=lq_tmp$x##2075][lq_tmp$x##2069:=rt1##a2uk][lq_tmp$x##2070:=lq_anf$##7205759403792806347##d3jB][lq_tmp$x##2071:=rt2##a2uo]
                                                                              &amp;&amp; rt2##a2uo &lt;= lq_tmp$x##2075}) | Data.Heap.Skew.size lq_anf$##7205759403792806347##d3jB == Data.Heap.Skew.size lq_tmp$x##2065
                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806347##d3jB == Data.Heap.Skew.elts lq_tmp$x##2065}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>boundedSkewTransitive</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2076 : a | lq_tmp$x##2076 == rt1##a2uk}</span><span class='hs-varid'>rt1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2050 : (Data.Heap.Skew.Skew {lq_tmp$x##2056 : a^"lq_tmp$x##2055" | $k_##2054[VV##2053:=lq_tmp$x##2056][lq_tmp$x##2052:=lq_anf$##7205759403792806346##d3jA]
                                                                              &amp;&amp; Data.Heap.Skew.minimum lq_anf$##7205759403792806346##d3jA &lt;= lq_tmp$x##2056}) | Data.Heap.Skew.size lq_anf$##7205759403792806346##d3jA == Data.Heap.Skew.size lq_tmp$x##2050
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.elts lq_anf$##7205759403792806346##d3jA == Data.Heap.Skew.elts lq_tmp$x##2050}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>skewBoundedByRoot</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2030 : (Data.Heap.Skew.Skew {lq_tmp$x##2040 : a^"lq_tmp$x##2039" | $k_##2038[VV##2037:=lq_tmp$x##2040][lq_tmp$x##2034:=rt1##a2uk][lq_tmp$x##2035:=l1##a2ul][lq_tmp$x##2036:=r1##a2um]}) | Data.Heap.Skew.right lq_tmp$x##2030 == r1##a2um
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.left lq_tmp$x##2030 == l1##a2ul
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.root lq_tmp$x##2030 == rt1##a2uk
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.elts lq_tmp$x##2030 == Set_cup (Set_cup (Set_sng rt1##a2uk) (Data.Heap.Skew.elts l1##a2ul)) (Data.Heap.Skew.elts r1##a2um)
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.minimum lq_tmp$x##2030 == rt1##a2uk
                                                                                                                                                                                                     &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2030 == (1 + Data.Heap.Skew.size l1##a2ul) + Data.Heap.Skew.size r1##a2um}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Node</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2041 : a | lq_tmp$x##2041 == rt1##a2uk}</span><span class='hs-varid'>rt1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2043 : (Data.Heap.Skew.Skew {lq_tmp$x##2042 : a | rt1##a2uk &lt;= lq_tmp$x##2042}) | Data.Heap.Skew.size lq_tmp$x##2043 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2043 == l1##a2ul}</span><span class='hs-varid'>l1</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2045 : (Data.Heap.Skew.Skew {lq_tmp$x##2044 : a | rt1##a2uk &lt;= lq_tmp$x##2044}) | Data.Heap.Skew.size lq_tmp$x##2045 &gt;= 0
                                                                                             &amp;&amp; lq_tmp$x##2045 == r1##a2um}</span><span class='hs-varid'>r1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2079 : a | lq_tmp$x##2079 == rt2##a2uo}</span><span class='hs-varid'>rt2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>214: </span>
<span class=hs-linenum>215: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>216: </span><span class='hs-comment'>-- -- -- Basic operations</span>
<span class=hs-linenum>217: </span><span class='hs-comment'>-- -- ----------------------------------------------------------------</span>
<span class=hs-linenum>218: </span>
<span class=hs-linenum>219: </span><span class='hs-comment'>-- -- {-| Checking validity of a heap.</span>
<span class=hs-linenum>220: </span><span class='hs-comment'>-- -- -}</span>
<span class=hs-linenum>221: </span>
<span class=hs-linenum>222: </span><span class='hs-comment'>-- -- valid :: Ord a =&gt; Skew a -&gt; Bool</span>
<span class=hs-linenum>223: </span><span class='hs-comment'>-- -- valid t = isOrdered (heapSort t)</span>
<span class=hs-linenum>224: </span>
<span class=hs-linenum>225: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>IncrList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-varop'>&lt;</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>xi</span> <span class='hs-varid'>xj</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xi</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>xj</span><span class='hs-layout'>}</span><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>226: </span>
<span class=hs-linenum>227: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>heapSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>s</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span> <span class='hs-conid'>IncrList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| len v = size s}</span> <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>s</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>228: </span><span class='hs-definition'>heapSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Skew</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>229: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##2423:(Data.Heap.Skew.Skew a) -&gt; {VV##0 : [a]&lt;\lq_tmp$x##2424 VV -&gt; {VV : a | lq_tmp$x##2424 &lt;= VV}&gt; | len VV##0 == Data.Heap.Skew.size lq_tmp$x##2423}</span><span class='hs-definition'>heapSort</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a &lt;p :: a a -&gt; Bool&gt; .
{lq_tmp$x##2442 : [a]&lt;\lq_tmp$x##2443 VV -&gt; {lq_tmp$x##2441 : a&lt;p lq_tmp$x##2443&gt; | true}&gt; | Data.Heap.Skew.eltsList lq_tmp$x##2442 == Set_empty 0
                                                                                             &amp;&amp; Set_emp (listElts lq_tmp$x##2442)
                                                                                             &amp;&amp; len lq_tmp$x##2442 == 0}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>230: </span><span class='hs-definition'>heapSort</span> <span class='hs-varid'>h</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>231: </span>    <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##2508 : a^"lq_tmp$x##2510" | $k_##2509}</span><span class='hs-varid'>minElt</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##2550 : (Data.Heap.Skew.Skew {VV##2547 : a^"lq_tmp$x##2549" | $k_##2548})^"lq_tmp$x##2552" | $k_##2551}</span><span class='hs-varid'>h'</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2493 : ({lq_tmp$x##2502 : a^"lq_tmp$x##2501" | $k_##2500[VV##2499:=lq_tmp$x##2502][lq_tmp$x##2496:=fix$36$$36$dOrd_a39l][lq_tmp$x##2497:=ds_d3hq]}, (Data.Heap.Skew.Skew {lq_tmp$x##2502 : a^"lq_tmp$x##2501" | $k_##2500[VV##2499:=lq_tmp$x##2502][lq_tmp$x##2496:=fix$36$$36$dOrd_a39l][lq_tmp$x##2497:=ds_d3hq]
                                                                                                                                                                                                                           &amp;&amp; fst lq_tmp$x##2493 &lt;= lq_tmp$x##2502})) | Data.Heap.Skew.size (snd lq_tmp$x##2493) + 1 == Data.Heap.Skew.size ds_d3hq
                                                                                                                                                                                                                                                                        &amp;&amp; Set_cup (Data.Heap.Skew.elts (snd lq_tmp$x##2493)) (Set_sng (fst lq_tmp$x##2493)) == Data.Heap.Skew.elts ds_d3hq}</span><span class='hs-varid'>deleteMin2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2506 : (Data.Heap.Skew.Skew a) | Data.Heap.Skew.size lq_tmp$x##2506 &gt;= 0
                                            &amp;&amp; lq_tmp$x##2506 == ds_d3hq}</span><span class='hs-varid'>h</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>232: </span>        <a class=annot href="#"><span class=annottext>{lq_tmp$x##2636 : a^"lq_tmp$x##2510" | $k_##2509[VV##2508:=lq_tmp$x##2636]
                                       &amp;&amp; lq_tmp$x##2636 == minElt##a39s}</span><span class='hs-varid'>minElt</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{VV##0 : [{lq_tmp$x##2605 : a^"lq_tmp$x##2604" | $k_##2603[VV##2602:=lq_tmp$x##2605][lq_tmp$x##2422:=fix$36$$36$dOrd_a39l][lq_tmp$x##2423:=h'##a39u]}]&lt;\lq_tmp$x##2424 VV -&gt; {lq_tmp$x##2605 : a^"lq_tmp$x##2604" | lq_tmp$x##2424 &lt;= lq_tmp$x##2605}&gt; | len VV##0 == Data.Heap.Skew.size h'##a39u}</span><span class='hs-varid'>heapSort</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2609 : (Data.Heap.Skew.Skew {lq_tmp$x##2608 : a^"lq_tmp$x##2549" | $k_##2548[VV##2547:=lq_tmp$x##2608][VV##2550:=lq_tmp$x##2609]})^"lq_tmp$x##2552" | $k_##2551[VV##2550:=lq_tmp$x##2609]
                                                                                                                                                                 &amp;&amp; Data.Heap.Skew.size lq_tmp$x##2609 &gt;= 0
                                                                                                                                                                 &amp;&amp; lq_tmp$x##2609 == h'##a39u}</span><span class='hs-varid'>h'</span></a>
<span class=hs-linenum>233: </span>
<span class=hs-linenum>234: </span><span class='hs-comment'>-- {-@ heapSort :: h:(Heap a) -&gt; {v:IncrList a | len v == heapSize h} / [heapSize h] @-}</span>
<span class=hs-linenum>235: </span><span class='hs-comment'>-- heapSort :: Ord a =&gt; Heap a -&gt; [a]</span>
<span class=hs-linenum>236: </span><span class='hs-comment'>-- heapSort (Heap []) = []</span>
<span class=hs-linenum>237: </span><span class='hs-comment'>-- heapSort h@(Heap (_:_)) =</span>
<span class=hs-linenum>238: </span><span class='hs-comment'>--   let (minElt, h') = deleteMin2 h in</span>
<span class=hs-linenum>239: </span><span class='hs-comment'>--   minElt : heapSort h'</span>
<span class=hs-linenum>240: </span>
<span class=hs-linenum>241: </span><span class='hs-comment'>-- -- isOrdered :: Ord a =&gt; [a] -&gt; Bool</span>
<span class=hs-linenum>242: </span><span class='hs-comment'>-- -- isOrdered [] = True</span>
<span class=hs-linenum>243: </span><span class='hs-comment'>-- -- isOrdered [_] = True</span>
<span class=hs-linenum>244: </span><span class='hs-comment'>-- -- isOrdered (x:y:xys) = x &lt;= y &amp;&amp; isOrdered (y:xys) -- allowing duplicated keys</span></pre>
</body>
</html>